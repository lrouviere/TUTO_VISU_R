<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Visualisation avec R - 9&nbsp; Estimation et intervalles de confiance</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09-regression.html" rel="next">
<link href="./07-shiny.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>

<script src="site_libs/htmlwidgets-1.6.3/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.30/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./08-estimation.html">Statistique avec R</a></li><li class="breadcrumb-item"><a href="./08-estimation.html"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Estimation et intervalles de confiance</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualisation avec R</a> 
        <div class="sidebar-tools-main tools-wide">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Visualisation-avec-R.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Visualisation-avec-R.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Basculer en mode lecteur">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Présentation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Logiciel R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-objetsR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Les objets R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Manipuler les données avec dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./031-programmer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Programmer</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Visualisation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Visualisation avec ggplot2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-carto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Faire des cartes avec R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-interactif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Quelques outils de visualisation dynamique/interactive</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Applications web avec Shiny</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Statistique avec R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-estimation.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Estimation et intervalles de confiance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Régression avec R</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#générer-des-observations-selon-des-lois-de-probabilités" id="toc-générer-des-observations-selon-des-lois-de-probabilités" class="nav-link active" data-scroll-target="#générer-des-observations-selon-des-lois-de-probabilités"><span class="header-section-number">9.1</span> Générer des observations selon des lois de probabilités</a></li>
  <li><a href="#une-étude-numérique-de-la-moyenne-empirique." id="toc-une-étude-numérique-de-la-moyenne-empirique." class="nav-link" data-scroll-target="#une-étude-numérique-de-la-moyenne-empirique."><span class="header-section-number">9.2</span> Une étude numérique de la moyenne empirique.</a>
  <ul class="collapse">
  <li><a href="#exemple" id="toc-exemple" class="nav-link" data-scroll-target="#exemple"><span class="header-section-number">9.2.1</span> Exemple</a></li>
  </ul></li>
  <li><a href="#intervalles-de-confiance" id="toc-intervalles-de-confiance" class="nav-link" data-scroll-target="#intervalles-de-confiance"><span class="header-section-number">9.3</span> Intervalles de confiance</a></li>
  <li><a href="#vers-des-modèles-plus-complexes" id="toc-vers-des-modèles-plus-complexes" class="nav-link" data-scroll-target="#vers-des-modèles-plus-complexes"><span class="header-section-number">10</span> Vers des modèles plus complexes</a>
  <ul class="collapse">
  <li><a href="#étude-descriptive-et-visualisation" id="toc-étude-descriptive-et-visualisation" class="nav-link" data-scroll-target="#étude-descriptive-et-visualisation"><span class="header-section-number">10.1</span> Étude descriptive et visualisation</a></li>
  <li><a href="#modèle-mixte" id="toc-modèle-mixte" class="nav-link" data-scroll-target="#modèle-mixte"><span class="header-section-number">10.2</span> Modèle mixte</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="estimation" class="quarto-section-identifier"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Estimation et intervalles de confiance</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">

</div>
<style>
div.correction {
  color: black;
  background-color: #F0F0F0;
  font-style: normal;
  /*display: none;*/
}

.corR {
  font-style: italic;
  /*display: none;*/
}
</style>
<p>Dans cette partie nous allons construire des échantillons par simulation et nous intéresser à l’étude de la moyenne de ces échantillons.</p>
<section id="générer-des-observations-selon-des-lois-de-probabilités" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="générer-des-observations-selon-des-lois-de-probabilités"><span class="header-section-number">9.1</span> Générer des observations selon des lois de probabilités</h2>
<p><strong>R</strong> étant un logiciel de statistique, il est bien entendu possible de</p>
<ul>
<li>visualiser</li>
<li>calculer des indicateurs (quantiles, probabilités…)</li>
<li>générer des observations</li>
</ul>
<p>pour toutes les lois classiques de probabilités. Chaque loi va être identifiée par une chaîne de caractères :</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: center;">Loi</th>
<th style="text-align: center;">Chaîne</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Binomiale</td>
<td style="text-align: center;">binom</td>
</tr>
<tr class="even">
<td style="text-align: center;">Poisson</td>
<td style="text-align: center;">pois</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Uniforme</td>
<td style="text-align: center;">unif</td>
</tr>
<tr class="even">
<td style="text-align: center;">Exponentielle</td>
<td style="text-align: center;">exp</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Normale</td>
<td style="text-align: center;">norm</td>
</tr>
</tbody>
</table>
<p>Un préfixe permettra de spécifier l’action que l’on souhaite effectuer sur la loi :</p>
<ul>
<li><strong>d</strong> : calculer la densité pour une loi continue ou la fonction de masse pour une loi discrète</li>
<li><strong>q</strong> : calculer les quantiles</li>
<li><strong>r</strong> : générer des observations.</li>
</ul>
<p>On pourra par exemple :</p>
<ul>
<li><p>Calculer la densité de la loi <span class="math inline">\(\mathcal N(0,1)\)</span> en -1,0,1 avec</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2419707 0.3989423 0.2419707</code></pre>
</div>
</div></li>
<li><p>Calculer les quantiles d’ordre 0.05, 0.5 et 0.95 de la loi <span class="math inline">\(\mathcal N(0,1)\)</span> en -1,0,1 avec</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="fu">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="fl">0.95</span>),<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1.644854  0.000000  1.644854</code></pre>
</div>
</div></li>
<li><p>Générer 10 observations selon une loi <span class="math inline">\(\mathcal N(0,1)\)</span> avec</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="at">mean=</span><span class="dv">0</span>,<span class="at">sd=</span><span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -1.42710099  0.58261915 -0.32025181  1.19344672  1.10258200  1.40879070
 [7]  0.01185247  0.70595264 -0.39462244 -2.89997478</code></pre>
</div>
</div></li>
</ul>
<div id="exr-exo-loibinomiale" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 9.1 (Loi binomiale) </strong></span>On étudie les fonctions <code>R</code> associées à la loi binomiale.</p>
<ol type="1">
<li><p>Soit <span class="math inline">\(X\)</span> un variable de loi binomiale <span class="math inline">\(B(20,0.6)\)</span>. Calculer la probabilité que <span class="math inline">\(X\)</span> soit égale à 1,5,10,15.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dbinom</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">15</span>),<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.298535e-07 1.294494e-03 1.171416e-01 7.464702e-02</code></pre>
</div>
</div></li>
<li><p>Pour la même loi calculer la probabilités : <span class="math display">\[\mathbf P(X\leq 13),\quad\mathbf P(X&gt;13),\quad \mathbf P(X\geq 13)\quad\text{et}\quad \mathbf P(X\in[8,15]).\]</span></p>
<div class="corR">
<p>Pour la première il suffit d’utiliser <code>pbinom</code> :</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">13</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.7499893</code></pre>
</div>
</div>
<p>On remarque ensuite que <span class="math display">\[\mathbf P(X&gt;13)=1-\mathbf P(X\leq 13)\quad\text{et}\quad\mathbf P(X\geq 13)=\mathbf P(X&gt;13)+\mathbf P(X=13)\]</span></p>
<p>donc</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">13</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2500107</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">13</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)<span class="sc">+</span><span class="fu">dbinom</span>(<span class="dv">13</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4158929</code></pre>
</div>
</div>
<p>Pour la dernière, on utilise <span class="math display">\[\mathbf P(X\in[8,15]=\mathbf P(X\leq 15)-\mathbf P(X\leq 8)+\mathbf P(X=8)\]</span></p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pbinom</span>(<span class="dv">15</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)<span class="sc">-</span><span class="fu">pbinom</span>(<span class="dv">8</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)<span class="sc">+</span><span class="fu">dbinom</span>(<span class="dv">8</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9280191</code></pre>
</div>
</div>
<p>On aurait aussi pu faire</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">dbinom</span>(<span class="dv">8</span><span class="sc">:</span><span class="dv">15</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9280191</code></pre>
</div>
</div>
</div></li>
<li><p>Représenter le diagramme en barre associé à la loi <span class="math inline">\(B(20,0.6)\)</span>. On pourra utiliser l’argument <strong>stat=“identity”</strong> dans la fonction <strong>geom_bar</strong>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>prob <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">20</span>,<span class="at">prob=</span>prob)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>prob)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>,<span class="at">width=</span><span class="fl">0.15</span>)<span class="sc">+</span><span class="fu">theme_classic</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
<li><p>Générer un échantillon de taille 5000 selon la loi <span class="math inline">\(B(20,0.6)\)</span>. Tracer le diagramme en barres associé à cet échantillon et comparer le à celui de la question précédente.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">5000</span>,<span class="at">size=</span><span class="dv">20</span>,<span class="at">prob=</span><span class="fl">0.6</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span>X)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>..prop..)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">width=</span><span class="fl">0.15</span>)<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span><span class="fu">xlim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="corR">
<p>On peut visualiser les digrammes en barres cote à cote avec</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fu">table</span>(X)<span class="sc">/</span><span class="dv">5000</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>prop1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">as.numeric</span>(<span class="fu">names</span>(prop)),<span class="at">Freq=</span><span class="fu">as.numeric</span>(prop))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">full_join</span>(df,prop1,<span class="at">by=</span><span class="fu">c</span>(<span class="st">"x"</span><span class="ot">=</span><span class="st">"X"</span>))</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(df2)[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Theo"</span>,<span class="st">"Emp"</span>)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>df2[<span class="fu">is.na</span>(df2)] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> df2 <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>x,<span class="at">names_to=</span><span class="st">"type"</span>,<span class="at">values_to=</span><span class="st">"valeur"</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df3)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>valeur,<span class="at">fill=</span>type)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>,<span class="at">position=</span><span class="st">'dodge'</span>,<span class="at">width=</span><span class="fl">0.25</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
</ol>
</div>
<div id="exr-exo-loinormale" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 9.2 (Loi normale) </strong></span>On considère ici la loi normale <span class="math inline">\(\mathcal N(\mu,\sigma^2)\)</span>.</p>
<ol type="1">
<li><p>Tracer la densité de la loi <span class="math inline">\(\mathcal N(0,1)\)</span>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">x=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">3</span>,<span class="at">by=</span><span class="fl">0.01</span>),<span class="at">y=</span><span class="fu">dnorm</span>(x))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)<span class="sc">+</span><span class="fu">geom_line</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
<li><p>Soit <span class="math inline">\(X\)</span> une variable aléatoire de loi <span class="math inline">\(\mathcal N(2,2^2)\)</span> (variance 4, écart-type 2). Calculer les probabilités suivantes : <span class="math display">\[\mathbf P(X=2),\quad \mathbf P(X\leq 2),\quad \mathbf P(X&lt;2),\quad \mathbf P(X&gt;3).\]</span></p>
<div class="corR">
<p>La première probabilité est nulle. Les deux suivantes sont égales et valent</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.5</code></pre>
</div>
</div>
<div class="corR">
<p>On obtient la dernière avec</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3085375</code></pre>
</div>
</div></li>
<li><p>Générer un échantillon de taille 5000 selon la loi <span class="math inline">\(\mathcal N(0,1)\)</span>. Tracer l’histogramme associé à cet échantillon et comparer le à la densité tracée à la question précédente (on pourra superposer les 2 représentations).</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">rnorm</span>(<span class="dv">5000</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>()<span class="sc">+</span><span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>df,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">"red"</span>,<span class="at">size=</span><span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
</ol>
</div>
</section>
<section id="une-étude-numérique-de-la-moyenne-empirique." class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="une-étude-numérique-de-la-moyenne-empirique."><span class="header-section-number">9.2</span> Une étude numérique de la moyenne empirique.</h2>
<p>On considère un échantillon de <span class="math inline">\(x_1,\dots,x_n\)</span> i.i.d de loi uniforme sur <span class="math inline">\([a,b]\)</span> avec <span class="math inline">\(a\)</span> et <span class="math inline">\(b\)</span> supposés inconnus. Le problème est d’estimer l’espérance de cette loi uniforme <span class="math display">\[\mathbf E[X]=\frac{a+b}{2}.\]</span></p>
<p>Un estimateur naturel est la moyenne empirique <span class="math display">\[\bar x_n=\frac{1}{n}\sum_{i=1}^nx_i\]</span> Remarquons déjà que la moyenne empirique dépend des observations <span class="math inline">\(x_1,\dots,x_n\)</span> : la moyenne va donc changer lorsque les observations changent.</p>
<section id="exemple" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1" class="anchored" data-anchor-id="exemple"><span class="header-section-number">9.2.1</span> Exemple</h3>
<p>Pour fixer les idées, on suppose dans cette partie que <span class="math inline">\(a=0\)</span> et <span class="math inline">\(b=1\)</span>. L’espérance à estimer vaut donc 0.5 (on peut faire comme si on le la connaissait pas.)</p>
<p>On considère deux échantillons de taille 20 générées selon une loi uniforme entre 0 et 1 :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ech1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>ech2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">20</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(ech1,ech2)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Les moyennes empiriques pour ces deux échantillons sont différentes :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">|&gt;</span> <span class="fu">summarise_all</span>(mean)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ech1      ech2
1 0.4262927 0.4334001</code></pre>
</div>
</div>
<p>La moyenne empirique peut-être considérée comme une <strong>variable aléatoire</strong> : elle va donc posséder une loi de probabilité, une espérance… Si on considère l’exemple précédent, on sent bien que la distribution de la moyenne empirique doit</p>
<ul>
<li>se répartir autours de 0.5 (qui est la valeur à estimer).</li>
<li>être de plus en plus concentrée autours de 0.5 lorsque le nombre d’observations <span class="math inline">\(n\)</span> augmente.</li>
</ul>
<p>On peut visualiser ce fait en considérant un grand nombre d’échantillon et en regardant comment se comporte les valeurs moyennes de chaque échantillon. Pour cela on</p>
<ol type="1">
<li><p>génère un nombre <span class="math inline">\(B\)</span> (grand) d’échantillons de taille <span class="math inline">\(n=20\)</span> selon une loi uniforme entre 0 et 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">20</span><span class="sc">*</span><span class="dv">5000</span>),<span class="at">nrow=</span><span class="dv">20</span>) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>calcule les moyennes obtenues pour chaque échantillon</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>moy <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">summarize_all</span>(mean)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">t</span>(moy))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        [,1]
V1 0.4719301
V2 0.4449401
V3 0.4833523
V4 0.3740339
V5 0.4132300
V6 0.3734092</code></pre>
</div>
</div></li>
<li><p>visualise la distribution de la moyenne de chaque échantillon (en traçant l’histogramme de ces valeurs par exemple).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>moy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">M=</span><span class="fu">t</span>(moy))</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(moy)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>M,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>)<span class="sc">+</span><span class="fu">theme_classic</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
</ol>
<p>On voit que cette distribution semble se comporter comme une <strong>distribution gaussienne</strong> autours de la vraie valeur (0.5). Le théorème central limite confirme (et surtout prouve) ce constat. En effet, le théorème central limite nous dit que cette moyenne <span class="math inline">\(\bar x_n\)</span> vérifie <span class="math display">\[\sqrt{n}\frac{\bar x_n-\mu}{\sigma}\to \mathcal N(0,1)\]</span> avec <span class="math inline">\(\mu=0.5\)</span> et <span class="math inline">\(\sigma=1/\sqrt{12}\)</span> ici. On a donc <span class="math display">\[\sqrt{n}\frac{\bar X_n-0.5}{1/\sqrt{12}}\to \mathcal N(0,1)\]</span> Ce qui signifie qu’on peut approcher la loi de <span class="math inline">\(\bar X_n\)</span> par la loi <span class="math inline">\(\mathcal N(0.5,1/(12n))\)</span> avec <span class="math inline">\(n=20\)</span>. On le retrouve sur notre exemple en supperposant cette distribution gaussienne sur l’histogramme</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.25</span>,<span class="fl">0.75</span>,<span class="at">by=</span><span class="fl">0.001</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x=</span>x,<span class="at">y=</span><span class="fu">dnorm</span>(x,<span class="fl">0.5</span>,<span class="dv">1</span><span class="sc">/</span>(<span class="fu">sqrt</span>(<span class="dv">12</span><span class="sc">*</span><span class="dv">20</span>))))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(moy)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>M,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">20</span>)<span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>df,<span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>y),<span class="at">color=</span><span class="st">"red"</span>,<span class="at">size=</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"x"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div id="exr-exo-TCL" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 9.3 (Théorème central limite) </strong></span>Faire le même travail pour des tailles d’échantillon de 50, 100 et 500. Interpréter.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">20</span><span class="sc">*</span><span class="dv">5000</span>),<span class="at">nrow=</span><span class="dv">20</span>) </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">50</span><span class="sc">*</span><span class="dv">5000</span>),<span class="at">nrow=</span><span class="dv">50</span>) </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">100</span><span class="sc">*</span><span class="dv">5000</span>),<span class="at">nrow=</span><span class="dv">100</span>) </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">500</span><span class="sc">*</span><span class="dv">5000</span>),<span class="at">nrow=</span><span class="dv">500</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n20=</span><span class="fu">apply</span>(df1,<span class="dv">2</span>,mean),<span class="at">n50=</span><span class="fu">apply</span>(df2,<span class="dv">2</span>,mean),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">n100=</span><span class="fu">apply</span>(df3,<span class="dv">2</span>,mean),<span class="at">n500=</span><span class="fu">apply</span>(df4,<span class="dv">2</span>,mean))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">gather</span>(<span class="at">key=</span><span class="st">"taille_ech"</span>,<span class="at">value=</span>x)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>)<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">fct_relevel</span>(taille_ech,<span class="st">"n20"</span>,<span class="st">"n50"</span>,<span class="st">"n100"</span>,<span class="st">"n500"</span>))<span class="sc">+</span><span class="fu">theme_classic</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="corR">
<p>On remarque que :</p>
<ul>
<li>dans tous les cas, la distribution de la moyenne empirique semble être gaussienne et centrée en 0.5 (qui est la valeur à estimer).</li>
<li>la dispersion augmente lorsque le nombre d’observations <span class="math inline">\(n\)</span> diminue (moins précis).</li>
</ul>
</div>
</div>
<div id="exr-exo-TCL2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 9.4 (Théorème central limite (toujours)) </strong></span>Faire le même exercice pour une loi gaussienne <span class="math inline">\(\mathcal N(1,2)\)</span> et une loi de Bernoulli <span class="math inline">\(\mathcal B(0.6)\)</span>.</p>
<div class="corR">
<p>Pour la loi <span class="math inline">\(\mathcal N(1,2)\)</span></p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">20</span><span class="sc">*</span><span class="dv">5000</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">20</span>) </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">50</span><span class="sc">*</span><span class="dv">5000</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">50</span>) </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">100</span><span class="sc">*</span><span class="dv">5000</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">100</span>) </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(<span class="dv">500</span><span class="sc">*</span><span class="dv">5000</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">nrow=</span><span class="dv">500</span>)</span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n20=</span><span class="fu">apply</span>(df1,<span class="dv">2</span>,mean),<span class="at">n50=</span><span class="fu">apply</span>(df2,<span class="dv">2</span>,mean),</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">n100=</span><span class="fu">apply</span>(df3,<span class="dv">2</span>,mean),<span class="at">n500=</span><span class="fu">apply</span>(df4,<span class="dv">2</span>,mean))</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">gather</span>(<span class="at">key=</span><span class="st">"taille_ech"</span>,<span class="at">value=</span>x)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">fct_relevel</span>(taille_ech,<span class="st">"n20"</span>,<span class="st">"n50"</span>,<span class="st">"n100"</span>,<span class="st">"n500"</span>),<span class="at">scales=</span><span class="st">"fixed"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Pour la <span class="math inline">\(\mathcal B(0.6)\)</span></p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">20</span><span class="sc">*</span><span class="dv">50000</span>,<span class="dv">1</span>,<span class="fl">0.6</span>),<span class="at">nrow=</span><span class="dv">20</span>) </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">50</span><span class="sc">*</span><span class="dv">50000</span>,<span class="dv">1</span>,<span class="fl">0.6</span>),<span class="at">nrow=</span><span class="dv">50</span>) </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>df3 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">100</span><span class="sc">*</span><span class="dv">50000</span>,<span class="dv">1</span>,<span class="fl">0.6</span>),<span class="at">nrow=</span><span class="dv">100</span>) </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>df4 <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rbinom</span>(<span class="dv">500</span><span class="sc">*</span><span class="dv">50000</span>,<span class="dv">1</span>,<span class="fl">0.6</span>),<span class="at">nrow=</span><span class="dv">500</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n20=</span><span class="fu">apply</span>(df1,<span class="dv">2</span>,mean),<span class="at">n50=</span><span class="fu">apply</span>(df2,<span class="dv">2</span>,mean),</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">n100=</span><span class="fu">apply</span>(df3,<span class="dv">2</span>,mean),<span class="at">n500=</span><span class="fu">apply</span>(df4,<span class="dv">2</span>,mean))</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> <span class="fu">gather</span>(<span class="at">key=</span><span class="st">"taille_ech"</span>,<span class="at">value=</span>x)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>x,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">30</span>)<span class="sc">+</span></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span><span class="fu">fct_relevel</span>(taille_ech,<span class="st">"n20"</span>,<span class="st">"n50"</span>,<span class="st">"n100"</span>,<span class="st">"n500"</span>),<span class="at">scales=</span><span class="st">"fixed"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Dans tous ces cas, on retrouve bien que la moyenne empirique a une distribution gaussienne autours de la valeur à estimer (l’espérance). La dispersion dépend de :</p>
<ul>
<li>la dispersion des observations (de la loi de <span class="math inline">\(x_i\)</span>) ;</li>
<li>du nombre d’observations.</li>
</ul>
<p>La moyenne empirique est donc d’autant plus <strong>précise</strong> que la <strong>variance des observations</strong> est petite et que le <strong>nombre d’observations</strong> est grand. Le théorème central limite permet de quantifier tout ça et donc de déduire des intervalles de confiance et de faire des tests…</p>
</div>
</div>
</section>
</section>
<section id="intervalles-de-confiance" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="intervalles-de-confiance"><span class="header-section-number">9.3</span> Intervalles de confiance</h2>
<p>On cherche ici à illustrer numériquement le niveau d’un intervalle de confiance. On rappelle que <span class="math inline">\([A,B]\)</span> est un IC de niveau <span class="math inline">\(1-\alpha\)</span> pour un paramètre <span class="math inline">\(\theta\)</span> si <span class="math display">\[P(\theta\in[A,B])=1-\alpha.\]</span></p>
<div id="exr-exo-ICgaussienne" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 9.5 (IC pour l’espérance d’une gaussienne) </strong></span>On fixe ici le niveau à 0.95 (<span class="math inline">\(\alpha=0.05\)</span>). On considère <span class="math inline">\(n\)</span> observations <span class="math inline">\(x_1,\dots,x_n\)</span> i.i.d de loi <span class="math inline">\(\mathcal N(\mu,1)\)</span> et on cherche un intervalle de confiance pour <span class="math inline">\(\mu\)</span>.</p>
<ol type="1">
<li><p>Générer <span class="math inline">\(n=100\)</span> observations i.i.d. selon la loi <span class="math inline">\(\mathcal N(\mu,1)\)</span> avec <span class="math inline">\(\mu=1\)</span>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>ech <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Calculer un intervalle de confiance pour <span class="math inline">\(\mu\)</span> de niveau 0.95.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(ech)<span class="sc">$</span>conf.int</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8038101 1.2314117
attr(,"conf.level")
[1] 0.95</code></pre>
</div>
</div></li>
<li><p>Selon-vous, peut-on dire que la probabilité que <span class="math inline">\(\mu\)</span> appartienne à l’intervalle trouvé est de 0.95 ? Si non, comment peut-on interpréter cette formule.</p>
<div class="corR">
<p><strong>Non</strong>. Dans notre cas, <span class="math inline">\(\mu\)</span> (qui vaut 1) appartient à l’intervalle trouvé. Dans la vraie vie, <span class="math inline">\(\mu\)</span> est inconnu. Ce que la formule nous dit, c’est que si nos données sont issues d’un loi <span class="math inline">\(\mathcal N(\mu,\sigma^2)\)</span>, on a une probabilité de 0.95 que <span class="math inline">\(\mu\)</span> appartienne à l’intervalle trouvé. Donc si on génère un très grand nombre d’échantillon i.i.d selon la loi <span class="math inline">\(\mathcal N(\mu,\sigma^2)\)</span>, alors dans 95% des cas, la vraie valeur de <span class="math inline">\(\mu\)</span> appartiendra à l’intervalle trouvé. C’est ce qu’on propose de vérifier dans les questions suivantes.</p>
</div></li>
<li><p>Générer 5000 échantillons i.i.d. de loi <span class="math inline">\(\mathcal N(1,1)\)</span> de tailles 100. On pourra mettre le tout dans une matrice de dimension <span class="math inline">\(5000\times 100\)</span>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>B,<span class="at">mean=</span>mu),<span class="at">nrow=</span>B)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Calculer un intervalle de confiance de niveau 0.95 pour chacun des 5000 échantillons. On pourra utiliser une boucle <strong>for</strong> ou la fonction <strong>apply</strong>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(X,<span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">t.test</span>(x)<span class="sc">$</span>conf.int[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Sur les 5000 intervalles obtenus, calculer le nombre de fois où la vraie valeur de <span class="math inline">\(\mu\)</span> (en l’occcurence ici 1) se trouve à l’intérieur de l’intervalle.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>b2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(b1))</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>b2 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">test=</span>mu<span class="sc">&gt;</span>V1 <span class="sc">&amp;</span> mu<span class="sc">&lt;</span>V2) <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">mean</span>(test))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mean(test)
1     0.9494</code></pre>
</div>
</div></li>
<li><p>Refaire les questions 5-6-7 avec des IC de niveau 0.90.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>c1 <span class="ot">&lt;-</span> <span class="fu">apply</span>(X,<span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">t.test</span>(x,<span class="at">conf.level=</span><span class="fl">0.90</span>)<span class="sc">$</span>conf.int[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>c2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(c1))</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>c2 <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">test=</span>mu<span class="sc">&gt;</span>V1 <span class="sc">&amp;</span> mu<span class="sc">&lt;</span>V2) <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="fu">mean</span>(test))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mean(test)
1      0.898</code></pre>
</div>
</div></li>
</ol>
</div>
<div id="exr-exo-ICiris" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 9.6 (IC pour les iris de Fisher) </strong></span>On considère les données sur les iris de Fisher. Construire un intervalle de confiance de niveau 90% pour les paramètres suivants :</p>
<ul>
<li><p>La longueur de Pétales moyenne</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(iris<span class="sc">$</span>Petal.Length,<span class="at">conf.level=</span><span class="fl">0.90</span>)<span class="sc">$</span>conf.int</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.519434 3.996566
attr(,"conf.level")
[1] 0.9</code></pre>
</div>
</div></li>
<li><p>La largeur de Sépales moyenne de l’espèce Setosa</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>sep_set <span class="ot">&lt;-</span> iris <span class="sc">|&gt;</span> <span class="fu">filter</span>(Species<span class="sc">==</span><span class="st">"setosa"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(Sepal.Width) </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sep_set,<span class="at">conf.level=</span><span class="fl">0.90</span>)<span class="sc">$</span>conf.int</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.338124 3.517876
attr(,"conf.level")
[1] 0.9</code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ou</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>iris <span class="sc">|&gt;</span> <span class="fu">filter</span>(Species<span class="sc">==</span><span class="st">"setosa"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Sepal.Width) <span class="sc">|&gt;</span> <span class="fu">t.test</span>(<span class="at">conf.level=</span><span class="fl">0.9</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  select(filter(iris, Species == "setosa"), Sepal.Width)
t = 63.946, df = 49, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
90 percent confidence interval:
 3.338124 3.517876
sample estimates:
mean of x 
    3.428 </code></pre>
</div>
</div></li>
<li><p>La largeur de Sépales moyenne des espèces Versicolor et Virginica</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>sep_vervin <span class="ot">&lt;-</span> iris <span class="sc">|&gt;</span> <span class="fu">filter</span>(Species<span class="sc">==</span><span class="st">"versicolor"</span> <span class="sc">|</span> Species <span class="sc">==</span><span class="st">"virginica"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(Sepal.Width) </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(sep_vervin,<span class="at">conf.level=</span><span class="fl">0.90</span>)<span class="sc">$</span>conf.int</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.81675 2.92725
attr(,"conf.level")
[1] 0.9</code></pre>
</div>
</div></li>
</ul>
</div>
<div id="exr-exo-ICproportion" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 9.7 (IC pour une proportion) </strong></span>On considère <span class="math inline">\(x_1,\dots,x_n\)</span> un échantillon i.i.d issu d’une loi de Bernoulli de paramètre <span class="math inline">\(p\in[0,1]\)</span> inconnu.</p>
<ol type="1">
<li><p>Proposer un estimateur <span class="math inline">\(\widehat p\)</span> pour <span class="math inline">\(p\)</span>.</p>
<div class="corR">
<p>On peut prendre <span class="math display">\[\widehat p=\bar x_n=\frac{1}{n}\sum_{i=1}^nx_i.\]</span></p>
</div></li>
<li><p>A l’aide du TCL, obtenir la loi asymptotique de <span class="math inline">\(\hat p\)</span>.</p>
<div class="corR">
<p>On a d’après la TCL</p>
<p><span class="math display">\[\sqrt{n}\frac{\widehat{p}-p}{\sqrt{p(1-p)}}\stackrel{\mathcal L}{\to}\mathcal N(0,1)\]</span></p>
</div></li>
<li><p>En déduire un intervalle de confiance de niveau <span class="math inline">\(1-\alpha\)</span> pour <span class="math inline">\(p\)</span>.</p>
<div class="corR">
<p>On déduit que <span class="math display">\[\left[\widehat p-q_{1-\alpha/2}\sqrt{\frac{p(1-p)}{n}}, \widehat p+q_{1-\alpha/2}\sqrt{\frac{p(1-p)}{n}}\right].\]</span></p>
<p>est un IC de niveau <span class="math inline">\(1-\alpha\)</span>.</p>
</div></li>
<li><p>Que pouvez-vous reprocher à l’intervalle proposé à la question précédente ?</p>
<div class="corR">
<p>L’IC proposé dépend de <span class="math inline">\(p\)</span> qui est inconnu ! Il ne sera donc pas calculable en pratique !</p>
</div></li>
<li><p>Proposer une solution.</p>
<div class="corR">
<p>Un solution classique consiste à remplacer le paramètre <span class="math inline">\(p\)</span> inconnu par son estimateur <span class="math inline">\(\widehat p\)</span>. On obtient ainsi l’IC <span class="math display">\[\left[\widehat p-q_{1-\alpha/2}\sqrt{\frac{\widehat p(1-\widehat p)}{n}}, \widehat p+q_{1-\alpha/2}\sqrt{\frac{\widehat p(1-\widehat p)}{n}}\right].\]</span></p>
</div></li>
</ol>
</div>
<div id="exr-exo-ICproportion2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 9.8 (IC pour une proportion (suite)) </strong></span>Afin de tenter de deviner qui va gagner une élection entre deux candidats <span class="math inline">\(A\)</span> et <span class="math inline">\(B\)</span> on effectue un sondage. On demande à 100 personnes pour qui elles vont voter. Les résultats sont reportés dans le vecteur suivant.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>res <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">100</span>,<span class="dv">1</span>,<span class="fl">0.52</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>On désigne par <span class="math inline">\(p\)</span> la propotion (inconnue) d’électeurs qui vont voter pour <span class="math inline">\(A\)</span>.</p>
<ol type="1">
<li><p>Proposer et calculer un estimateur de <span class="math inline">\(p\)</span>.</p>
<div class="corR">
<p>On peut prendre la moyenne empirique <span class="math display">\[\widehat p=\bar x_n=\frac{1}{n}\sum_{i=1}^nx_i.\]</span> On la calcule avec</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>phat <span class="ot">&lt;-</span> <span class="fu">mean</span>(res)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>phat</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.54</code></pre>
</div>
</div></li>
<li><p>Que pouvez-vous conclure a priori.</p>
<div class="corR">
<p>Il semble que <span class="math inline">\(A\)</span> va remporter l’élection.</p>
</div></li>
<li><p>En vous basant sur l’exercice précédent, calculer un intervalle de confiance de niveau 95% pour <span class="math inline">\(p\)</span>.</p>
<div class="corR">
<p>On le calcule avec</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(res)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>binf <span class="ot">&lt;-</span> phat<span class="sc">-</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sqrt</span>(phat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>phat)<span class="sc">/</span>n)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>bsup <span class="ot">&lt;-</span> phat<span class="sc">+</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)<span class="sc">*</span><span class="fu">sqrt</span>(phat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>phat)<span class="sc">/</span>n)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(binf,bsup)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4423159 0.6376841</code></pre>
</div>
</div></li>
<li><p>Est-ce que l’intervalle obtenu conforte votre conclusion de la question 2 ?</p>
<div class="corR">
<p>Non, en effet 0.5 se trouve dans l’intervalle de confiance !</p>
</div></li>
<li><p>Calculer un intervalle de confiance pour <span class="math inline">\(p\)</span> à l’aide de la fonction <strong>prop.test</strong>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.test</span>(<span class="fu">sum</span>(res),n)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test with continuity correction

data:  sum(res) out of n, null probability 0.5
X-squared = 0.49, df = 1, p-value = 0.4839
alternative hypothesis: true p is not equal to 0.5
95 percent confidence interval:
 0.4377639 0.6391280
sample estimates:
   p 
0.54 </code></pre>
</div>
</div>
<div class="corR">
<p>On remarque que l’IC obtenu ne correspond pas exactement à celui que nous avons calculé à la question 3. La fonction <strong>prop.test</strong> utilise une solution plus pertinente que de remplacer <span class="math inline">\(p\)</span> par son estimateur. La correction utilisée dans <strong>prop.test</strong> est plus préciser, il est recommandé d’utiliser celle là.</p>
</div></li>
</ol>
</div>
<div id="exr-exo-compmoyenne" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 9.9 (Comparaison de moyennes) </strong></span>Pour le jeu de données <code>decathlon</code> disponible ici</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FactoMineR)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(decathlon)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>on souhaite comparer les performances au 100m en fonction de la compétition (Decastar vs JO).</p>
<ol type="1">
<li><p>Calculer un intervalle de confiance de niveau 95% pour la vitesse moyenne au 100m au Decastar.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>perf.D <span class="ot">&lt;-</span> decathlon <span class="sc">|&gt;</span> <span class="fu">filter</span>(Competition<span class="sc">==</span><span class="st">"Decastar"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">100m</span><span class="st">`</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(perf.D)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  perf.D
t = 163.64, df = 12, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 11.02659 11.32418
sample estimates:
mean of x 
 11.17538 </code></pre>
</div>
</div></li>
<li><p>Même question pour les jeux olympiques.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>perf.JO <span class="ot">&lt;-</span> decathlon <span class="sc">|&gt;</span> <span class="fu">filter</span>(Competition<span class="sc">==</span><span class="st">"OlympicG"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="st">`</span><span class="at">100m</span><span class="st">`</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(perf.JO)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  perf.JO
t = 250.02, df = 27, p-value &lt; 2.2e-16
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 10.82613 11.00530
sample estimates:
mean of x 
 10.91571 </code></pre>
</div>
</div></li>
<li><p>Pouvez-vous conclure sur la question posée ? Si non, que faire ?</p>
<div class="corR">
<p>Il n’est pas possible de conclure. La bonne approche consiste à calculer un intervalle de confiance sur la différence moyenne des performances au 100m entre les deux compétitions et de regarder si 0 se situe dans l’intervalle.</p>
<p>On obtient l’intervalle avec</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(perf.D,perf.JO)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  perf.D and perf.JO
t = 3.2037, df = 22.168, p-value = 0.00407
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.09164794 0.42769272
sample estimates:
mean of x mean of y 
 11.17538  10.91571 </code></pre>
</div>
</div>
<div class="corR">
<p>0 n’étant pas dans l’intervalle, on conclut que les performances sont différentes. On verra par la suite que les tests d’hypothèses permettent de traiter ce genre de questions de façons plus efficace.</p>
</div></li>
</ol>
</div>
</section>
<section id="vers-des-modèles-plus-complexes" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Vers des modèles plus complexes</h1>
<p>On présente un cas d’étude dans cette partie. On se pose le problème d’étudier l’impact de l’activité sportive combiné à un régime sur le cancer. Pour se faire, on étudie l’évolution de tumeurs cancéreuses chez des souris réparties en 4 groupes :</p>
<ul>
<li><code>CTL</code> : groupe contrôle</li>
<li><code>EPA</code>: régime</li>
<li><code>ET</code> : activité physique</li>
<li><code>EPA ET</code> : régime et activité physique</li>
</ul>
<p>On importe les données</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>(data1 <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_excel</span>(<span class="st">"data/donnees_tum.xlsx"</span>, <span class="at">sheet =</span> <span class="st">"Tumeur"</span>,<span class="at">skip=</span><span class="dv">1</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 53 × 20
   Id        J5    J8   J12   J14   J16   J20   J22    J26    J28    J30    J34
   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
 1 CTL 1  11.3  10.5  11.1  10.4  11.9  19.8  21.8   30.1   33.1   43.3   85.5 
 2 CTL 2   0     5.29  5.83  5.22  5.77  4.47  4.79   5.06   5.13   5.00   6.21
 3 CTL 3  10.3  16.8  11.4  13.1  13.4  22.9  25.1   24.3   42.1   57.2  104.  
 4 CTL 4   6.00 11.4  25.5  32.0  34.3  69.2  85.2  137.   187.   212.   278.  
 5 CTL 5  15.9  11.6  14.1  11.0  18.0  19.5  21.0   47.4   82.1   81.7  156.  
 6 CTL 6   0     0     3.86  3.65 10.1  14.1  18.8   27.0   46.2   54.2   75.0 
 7 CTL 7  10.8  10.9  19.0  16.9  22.2  31.1  33.9   34.4   62.4   79.3  152.  
 8 CTL 8   9.00 13.3  16.2  15.4  16.4  22.6  22.0   16.9   15.5   17.8   29.4 
 9 CTL 9   3.75 11.2  10.5  11.3  30.3  52.5  59.4   82.1   97.7  126.   218.  
10 CTL 10 14.1  16.3  19.4  23.1  26.7  25.3  38.8   38.2   44.5   54.5   89.5 
# ℹ 43 more rows
# ℹ 8 more variables: J36 &lt;dbl&gt;, J40 &lt;dbl&gt;, J42 &lt;dbl&gt;, J44 &lt;dbl&gt;, J48 &lt;dbl&gt;,
#   J50 &lt;dbl&gt;, J54 &lt;dbl&gt;, J56 &lt;dbl&gt;</code></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data1)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 53 20</code></pre>
</div>
</div>
<p>et on les met sous un format long :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> data1 <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Id),<span class="at">names_to=</span><span class="st">"Day"</span>,<span class="at">values_to =</span> <span class="st">"Volume"</span>) <span class="sc">|&gt;</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">day_num=</span><span class="fu">as.numeric</span>(<span class="fu">str_remove</span>(Day,<span class="st">'[J]'</span>)),</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">groupe=</span><span class="fu">fct</span>(<span class="fu">str_remove</span>(Id,<span class="st">'[0-9]+'</span>)),</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Day=</span><span class="fu">fct</span>(Day))</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>data2</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,007 × 5
   Id    Day   Volume day_num groupe
   &lt;chr&gt; &lt;fct&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt; 
 1 CTL 1 J5      11.3       5 "CTL "
 2 CTL 1 J8      10.5       8 "CTL "
 3 CTL 1 J12     11.1      12 "CTL "
 4 CTL 1 J14     10.4      14 "CTL "
 5 CTL 1 J16     11.9      16 "CTL "
 6 CTL 1 J20     19.8      20 "CTL "
 7 CTL 1 J22     21.8      22 "CTL "
 8 CTL 1 J26     30.1      26 "CTL "
 9 CTL 1 J28     33.1      28 "CTL "
10 CTL 1 J30     43.3      30 "CTL "
# ℹ 997 more rows</code></pre>
</div>
</div>
<section id="étude-descriptive-et-visualisation" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="étude-descriptive-et-visualisation"><span class="header-section-number">10.1</span> Étude descriptive et visualisation</h2>
<p>On commence par visualiser l’évolution de la tumeur en fonction du groupe à l’aide d’un boxplot :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span><span class="fu">as.factor</span>(day_num),<span class="at">y=</span>Volume,<span class="at">color=</span>groupe)<span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"Day"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Il semble que les évolutions soient différentes, notamment pour le groupe contrôle.</p>
<p>On effectue maintenant une <strong>Anova</strong> pour tester l’effet groupe. Les répétitions portant sur le temps (et non sur les groupes), on fait l’ANOVA à deux facteurs avec (voir <a href="https://www.math.univ-toulouse.fr/~besse/Wikistat/pdf/st-m-modmixt7-mesrepet.pdf" class="uri">https://www.math.univ-toulouse.fr/~besse/Wikistat/pdf/st-m-modmixt7-mesrepet.pdf</a>)</p>
<ul>
<li><code>groupe</code> comme effet inter</li>
<li><code>Day</code> comme effet intra</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>res.aov <span class="ot">&lt;-</span> <span class="fu">anova_test</span>(</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data2, <span class="at">dv =</span> Volume, <span class="at">wid =</span> Id,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">between =</span> groupe,</span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">within =</span> Day</span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">get_anova_table</span>(res.aov)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ANOVA Table (type III tests)

      Effect  DFn   DFd      F        p p&lt;.05   ges
1     groupe 3.00 45.00  6.123 1.00e-03     * 0.155
2        Day 1.22 54.76 75.359 4.41e-13     * 0.480
3 groupe:Day 3.65 54.76  7.100 1.72e-04     * 0.207</code></pre>
</div>
</div>
<p>L’interaction est significative.</p>
<p>On peut aller un peu plus loin avec les tests post hoc. Par exemple, pour l’effet groupe à chaque pas de temps :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>one.way <span class="ot">&lt;-</span> data2 <span class="sc">|&gt;</span> </span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(day_num) <span class="sc">|&gt;</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">anova_test</span>(<span class="at">dv =</span> Volume, <span class="at">wid =</span> Id, <span class="at">between =</span> groupe) <span class="sc">|&gt;</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_anova_table</span>() <span class="sc">|&gt;</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">adjust_pvalue</span>(<span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>one.way <span class="sc">|&gt;</span> <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(day_num) <span class="sc">|&gt;</span> DT<span class="sc">::</span><span class="fu">datatable</span>() </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-62046a43780a3042490e" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-62046a43780a3042490e">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],[5,8,12,14,16,20,22,26,28,30,34,36,40,42,44,48,50,54,56],["groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe","groupe"],[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],[45,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49],[0.431,1.845,0.359,0.399,1.04,1.558,2.006,1.292,1.934,3.655,4.292,4.326,4.918,4.961,4.866,5.478,6.851,6.912,7.798],[0.732,0.151,0.783,0.754,0.383,0.211,0.125,0.288,0.136,0.019,0.008999999999999999,0.008999999999999999,0.005,0.004,0.005,0.003,0.000604,0.000568,0.000236],["","","","","","","","","","*","*","*","*","*","*","*","*","*","*"],[0.028,0.102,0.022,0.024,0.06,0.08699999999999999,0.109,0.073,0.106,0.183,0.208,0.209,0.231,0.233,0.23,0.251,0.295,0.297,0.323],[1,1,1,1,1,1,1,1,1,0.361,0.171,0.171,0.095,0.076,0.095,0.057,0.011476,0.010792,0.004484]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>day_num<\/th>\n      <th>Effect<\/th>\n      <th>DFn<\/th>\n      <th>DFd<\/th>\n      <th>F<\/th>\n      <th>p<\/th>\n      <th>p&lt;.05<\/th>\n      <th>ges<\/th>\n      <th>p.adj<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3,4,5,6,8,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Le <code>groupe</code> devient “de plus en plus significatif” lorsque le temps augmente (y compris avec la correction de Bonferonni).</p>
<p>On regarde maintenant les comparaisons par paires :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>pwc <span class="ot">&lt;-</span> data2 <span class="sc">|&gt;</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Day) <span class="sc">|&gt;</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pairwise_t_test</span>(</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>    Volume <span class="sc">~</span> groupe,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">p.adjust.method =</span> <span class="st">"bonferroni"</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(pwc)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item" id="htmlwidget-0629593683dbe9836c1f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0629593683dbe9836c1f">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114"],["J5","J5","J5","J5","J5","J5","J8","J8","J8","J8","J8","J8","J12","J12","J12","J12","J12","J12","J14","J14","J14","J14","J14","J14","J16","J16","J16","J16","J16","J16","J20","J20","J20","J20","J20","J20","J22","J22","J22","J22","J22","J22","J26","J26","J26","J26","J26","J26","J28","J28","J28","J28","J28","J28","J30","J30","J30","J30","J30","J30","J34","J34","J34","J34","J34","J34","J36","J36","J36","J36","J36","J36","J40","J40","J40","J40","J40","J40","J42","J42","J42","J42","J42","J42","J44","J44","J44","J44","J44","J44","J48","J48","J48","J48","J48","J48","J50","J50","J50","J50","J50","J50","J54","J54","J54","J54","J54","J54","J56","J56","J56","J56","J56","J56"],["Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume","Volume"],["CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET ","CTL ","CTL ","EPA ","CTL ","EPA ","ET "],["EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET ","EPA ","ET ","ET ","EPA ET ","EPA ET ","EPA ET "],[13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13],[13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14,13,13,13,14,14,14],[0.277,0.78,0.44,0.582,0.58,0.804,0.233,0.284,0.0264,0.637,0.454,0.121,0.677,0.544,0.308,0.905,0.587,0.618,0.613,0.579,0.291,0.834,0.47,0.722,0.587,0.423,0.182,0.323,0.126,0.862,0.297,0.27,0.952,0.0356,0.282,0.31,0.297,0.0898,0.501,0.0234,0.211,0.5659999999999999,0.154,0.141,0.961,0.07770000000000001,0.743,0.781,0.0917,0.103,0.952,0.0265,0.594,0.552,0.0231,0.0105,0.755,0.00446,0.556,0.786,0.0103,0.00521,0.799,0.0028,0.669,0.866,0.0106,0.00767,0.903,0.00196,0.575,0.662,0.00273,0.00537,0.8090000000000001,0.00172,0.919,0.728,0.00265,0.0044,0.857,0.00182,0.9429999999999999,0.799,0.00322,0.00376,0.956,0.00218,0.9360000000000001,0.892,0.00182,0.00357,0.8139999999999999,0.000899,0.859,0.678,0.0004,0.00108,0.745,0.000371,0.964,0.775,0.000371,0.000659,0.853,0.00052,0.859,0.992,0.000222,0.000357,0.88,0.000183,0.99,0.888],["ns","ns","ns","ns","ns","ns","ns","ns","*","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","*","ns","ns","ns","ns","ns","*","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","*","ns","ns","*","*","ns","**","ns","ns","*","**","ns","**","ns","ns","*","**","ns","**","ns","ns","**","**","ns","**","ns","ns","**","**","ns","**","ns","ns","**","**","ns","**","ns","ns","**","**","ns","***","ns","ns","***","**","ns","***","ns","ns","***","***","ns","***","ns","ns","***","***","ns","***","ns","ns"],[1,1,1,1,1,1,1,1,0.158,1,1,0.726,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.759,1,1,1,1,0.214,1,1,1,0.539,1,0.14,1,1,0.926,0.847,1,0.466,1,1,0.55,0.62,1,0.159,1,1,0.138,0.06320000000000001,1,0.0268,1,1,0.0619,0.0313,1,0.0168,1,1,0.0635,0.046,1,0.0118,1,1,0.0164,0.0322,1,0.0103,1,1,0.0159,0.0264,1,0.0109,1,1,0.0193,0.0226,1,0.0131,1,1,0.0109,0.0214,1,0.00539,1,1,0.0024,0.00651,1,0.00222,1,1,0.00223,0.00395,1,0.00312,1,1,0.00133,0.00214,1,0.0011,1,1],["ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","ns","*","ns","ns","ns","*","ns","*","ns","ns","ns","*","ns","*","ns","ns","*","*","ns","*","ns","ns","*","*","ns","*","ns","ns","*","*","ns","*","ns","ns","*","*","ns","**","ns","ns","**","**","ns","**","ns","ns","**","**","ns","**","ns","ns","**","**","ns","**","ns","ns"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Day<\/th>\n      <th>.y.<\/th>\n      <th>group1<\/th>\n      <th>group2<\/th>\n      <th>n1<\/th>\n      <th>n2<\/th>\n      <th>p<\/th>\n      <th>p.signif<\/th>\n      <th>p.adj<\/th>\n      <th>p.adj.signif<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[5,6,7,9]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>pwc <span class="sc">|&gt;</span> <span class="fu">filter</span>(p.signif<span class="sc">!=</span><span class="st">"ns"</span> <span class="sc">|</span> p.adj.signif<span class="sc">!=</span><span class="st">"ns"</span>) <span class="sc">|&gt;</span> <span class="fu">arrange</span>(p)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 34 × 10
   Day   .y.    group1 group2     n1    n2       p p.signif   p.adj p.adj.signif
   &lt;fct&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;int&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt; &lt;chr&gt;       
 1 J56   Volume "CTL " "EPA E…    13    14 1.83e-4 ***      0.0011  **          
 2 J56   Volume "CTL " "EPA "     13    13 2.22e-4 ***      0.00133 **          
 3 J56   Volume "CTL " "ET "      13    13 3.57e-4 ***      0.00214 **          
 4 J50   Volume "CTL " "EPA E…    13    14 3.71e-4 ***      0.00222 **          
 5 J54   Volume "CTL " "EPA "     13    13 3.71e-4 ***      0.00223 **          
 6 J50   Volume "CTL " "EPA "     13    13 4   e-4 ***      0.0024  **          
 7 J54   Volume "CTL " "EPA E…    13    14 5.2 e-4 ***      0.00312 **          
 8 J54   Volume "CTL " "ET "      13    13 6.59e-4 ***      0.00395 **          
 9 J48   Volume "CTL " "EPA E…    13    14 8.99e-4 ***      0.00539 **          
10 J50   Volume "CTL " "ET "      13    13 1.08e-3 **       0.00651 **          
# ℹ 24 more rows</code></pre>
</div>
</div>
<p>Le groupe <code>CTL</code> se retrouve fréquemment dans les comparaisons significatives.</p>
</section>
<section id="modèle-mixte" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="modèle-mixte"><span class="header-section-number">10.2</span> Modèle mixte</h2>
<p>Les données étant répétées dans le temps, on ne peut pas utiliser un modèle linéaire classique. Il faut dans ce cas entraîner un modèle mixte qui va pouvoir prendre en compte les effets individuels :</p>
<p>Après plusieurs essais et comparaisons de modèle, on retient le modèle avec</p>
<ul>
<li>comme <code>effet fixe</code> : le temps au carré et l’interaction temps au carré vs groupe.</li>
<li>comme <code>effet aléatoire</code> : la constante et le temps au carré.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lme</span>(Volume<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>(groupe),</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">random=</span><span class="fu">list</span>(<span class="at">Id=</span><span class="fu">pdDiag</span>(<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>))),</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>data2,<span class="at">na.action=</span>na.omit)</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="fu">Anova</span>(m1,<span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: Volume
                     Chisq Df Pr(&gt;Chisq)    
(Intercept)         17.050  1  3.641e-05 ***
I(day_num^2)        81.249  1  &lt; 2.2e-16 ***
I(day_num^2):groupe 20.854  3  0.0001129 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>On retrouve bien que l’interaction est significative. Au niveau des paramètres du modèle on a :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: data2 
       AIC      BIC    logLik
  10249.63 10288.87 -5116.813

Random effects:
 Formula: ~1 + I(day_num^2) | Id
 Structure: Diagonal
        (Intercept) I(day_num^2) Residual
StdDev:    27.17808   0.06523892 32.77535

Fixed effects:  Volume ~ 1 + I(day_num^2) + I(day_num^2):(groupe) 
                                Value Std.Error  DF   t-value p-value
(Intercept)                -16.831664  4.076271 946 -4.129182   0e+00
I(day_num^2)                 0.164154  0.018211 946  9.013850   0e+00
I(day_num^2):groupeEPA      -0.098116  0.025751 946 -3.810174   1e-04
I(day_num^2):groupeET       -0.092033  0.025751 946 -3.573908   4e-04
I(day_num^2):groupeEPA ET   -0.096512  0.025287 946 -3.816676   1e-04
 Correlation: 
                           (Intr) I(d_^2) I(_^2):EP I(_^2):ET
I(day_num^2)               -0.018                            
I(day_num^2):groupeEPA      0.000 -0.707                     
I(day_num^2):groupeET       0.000 -0.707   0.500             
I(day_num^2):groupeEPA ET   0.000 -0.720   0.509     0.509   

Standardized Within-Group Residuals:
         Min           Q1          Med           Q3          Max 
-5.702141384 -0.381625266  0.002515069  0.372061286  8.789202686 

Number of Observations: 1003
Number of Groups: 53 </code></pre>
</div>
</div>
<p>Tous les coefficients de l’interaction sont significatifs et négatifs. Cela signifie que, le volume augmente moins vite avec de l’entraînement et du régime. On peut regarder ce qui se passe en changeant le groupe de référence :</p>
<ul>
<li><p>groupe <code>EPA</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lme</span>(Volume<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>(groupe),</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">random=</span><span class="fu">list</span>(<span class="at">Id=</span><span class="fu">pdDiag</span>(<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>))),</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">groupe=</span><span class="fu">contr.treatment</span>(<span class="fu">levels</span>(data2<span class="sc">$</span>groupe),<span class="at">base=</span><span class="dv">2</span>)),</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>data2,<span class="at">na.action=</span>na.omit)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)<span class="sc">$</span>tTable <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              Value Std.Error  DF t-value p-value
(Intercept)                -16.8317    4.0763 946 -4.1292  0.0000
I(day_num^2)                 0.0660    0.0182 946  3.6261  0.0003
I(day_num^2):groupeCTL       0.0981    0.0258 946  3.8102  0.0001
I(day_num^2):groupeET        0.0061    0.0258 946  0.2362  0.8133
I(day_num^2):groupeEPA ET    0.0016    0.0253 946  0.0634  0.9494</code></pre>
</div>
</div></li>
<li><p>groupe <code>ET</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lme</span>(Volume<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>(groupe),</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">random=</span><span class="fu">list</span>(<span class="at">Id=</span><span class="fu">pdDiag</span>(<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>))),</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">groupe=</span><span class="fu">contr.treatment</span>(<span class="fu">levels</span>(data2<span class="sc">$</span>groupe),<span class="at">base=</span><span class="dv">3</span>)),</span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>data2,<span class="at">na.action=</span>na.omit)</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)<span class="sc">$</span>tTable <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                              Value Std.Error  DF t-value p-value
(Intercept)                -16.8317    4.0763 946 -4.1292  0.0000
I(day_num^2)                 0.0721    0.0182 946  3.9600  0.0001
I(day_num^2):groupeCTL       0.0920    0.0258 946  3.5739  0.0004
I(day_num^2):groupeEPA      -0.0061    0.0258 946 -0.2362  0.8133
I(day_num^2):groupeEPA ET   -0.0045    0.0253 946 -0.1771  0.8595</code></pre>
</div>
</div></li>
<li><p>groupe <code>EPA - ET</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lme</span>(Volume<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>)<span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>)<span class="sc">:</span>(groupe),</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>          <span class="at">random=</span><span class="fu">list</span>(<span class="at">Id=</span><span class="fu">pdDiag</span>(<span class="sc">~</span><span class="dv">1</span><span class="sc">+</span><span class="fu">I</span>(day_num<span class="sc">^</span><span class="dv">2</span>))),</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">groupe=</span><span class="fu">contr.treatment</span>(<span class="fu">levels</span>(data2<span class="sc">$</span>groupe),<span class="at">base=</span><span class="dv">4</span>)),</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">data=</span>data2,<span class="at">na.action=</span>na.omit)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m4)<span class="sc">$</span>tTable <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="dv">4</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           Value Std.Error  DF t-value p-value
(Intercept)             -16.8317    4.0763 946 -4.1292  0.0000
I(day_num^2)              0.0676    0.0175 946  3.8543  0.0001
I(day_num^2):groupeCTL    0.0965    0.0253 946  3.8167  0.0001
I(day_num^2):groupeEPA   -0.0016    0.0253 946 -0.0634  0.9494
I(day_num^2):groupeET     0.0045    0.0253 946  0.1771  0.8595</code></pre>
</div>
</div></li>
</ul>
<p>À chaque fois le groupe <code>CTL</code> se distingue. Il est difficile d’établir des différences significatives entre les autres groupes. On peut enfin visualiser les effets fixes :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>aa <span class="ot">&lt;-</span> <span class="fu">predict</span>(m1,data2,<span class="at">level=</span><span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>data3 <span class="ot">&lt;-</span> data2 <span class="sc">|&gt;</span> </span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prev=</span>aa<span class="sc">$</span>predict.Id) <span class="sc">|&gt;</span> </span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(groupe,day_num) <span class="sc">|&gt;</span> </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">moy=</span><span class="fu">mean</span>(prev))</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data3)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>day_num,<span class="at">y=</span>moy,<span class="at">color=</span>groupe)<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="08-estimation_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./07-shiny.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Applications web avec Shiny</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09-regression.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Régression avec R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>