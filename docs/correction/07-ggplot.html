<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Visualisation avec R - 7&nbsp; Visualisation avec ggplot2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08-carto.html" rel="next">
<link href="./06-scraping.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Pas de résultats",
    "search-matching-documents-text": "documents trouvés",
    "search-copy-link-title": "Copier le lien vers la recherche",
    "search-hide-matches-text": "Cacher les correspondances additionnelles",
    "search-more-match-text": "correspondance de plus dans ce document",
    "search-more-matches-text": "correspondances de plus dans ce document",
    "search-clear-button-title": "Effacer",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Annuler",
    "search-submit-button-title": "Envoyer",
    "search-label": "Recherche"
  }
}</script>
<script src="site_libs/htmlwidgets-1.6.3/htmlwidgets.js"></script>
<script src="site_libs/amcharts-3.21.13/amcharts.js"></script>
<script src="site_libs/ramcharts_base-binding-2.1.15/ramcharts_base.js"></script>
<script src="site_libs/amcharts_type_serial-3.20.18/serial.js"></script>
<script src="site_libs/amcharts_themes_light.js-3.20.18/light.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="style.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-ggplot.html">Visualisation</a></li><li class="breadcrumb-item"><a href="./07-ggplot.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualisation avec ggplot2</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Basculer la barre latérale" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Visualisation avec R</a> 
        <div class="sidebar-tools-main tools-wide">
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Visualisation-avec-R.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Visualisation-avec-R.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Basculer en mode lecteur">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Recherche"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Présentation</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Logiciel R - Les bases</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-objetsR.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Les objets R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Manipuler les données avec dplyr</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Outils avancés</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-programmer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Programmer</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-bdd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Base de données</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-scraping.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Web scraping</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Visualisation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-ggplot.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualisation avec ggplot2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-carto.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Faire des cartes avec R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-interactif.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Quelques outils de visualisation dynamique/interactive</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-shiny.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Applications web avec Shiny</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Statistique avec R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Basculer la section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Estimation et intervalles de confiance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Régression avec R</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Références</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table des matières</h2>
   
  <ul>
  <li><a href="#fonctions-graphiques-conventionnelles" id="toc-fonctions-graphiques-conventionnelles" class="nav-link active" data-scroll-target="#fonctions-graphiques-conventionnelles"><span class="header-section-number">7.1</span> Fonctions graphiques conventionnelles</a>
  <ul class="collapse">
  <li><a href="#la-fonction-plot" id="toc-la-fonction-plot" class="nav-link" data-scroll-target="#la-fonction-plot"><span class="header-section-number">7.1.1</span> La fonction <strong>plot</strong></a></li>
  <li><a href="#graphes-interactifs-avec-ramcharts" id="toc-graphes-interactifs-avec-ramcharts" class="nav-link" data-scroll-target="#graphes-interactifs-avec-ramcharts"><span class="header-section-number">7.1.2</span> Graphes interactifs avec rAmCharts</a></li>
  <li><a href="#quelques-exercices" id="toc-quelques-exercices" class="nav-link" data-scroll-target="#quelques-exercices"><span class="header-section-number">7.1.3</span> Quelques exercices</a></li>
  </ul></li>
  <li><a href="#la-grammaire-ggplot2" id="toc-la-grammaire-ggplot2" class="nav-link" data-scroll-target="#la-grammaire-ggplot2"><span class="header-section-number">7.2</span> La grammaire <strong>ggplot2</strong></a>
  <ul class="collapse">
  <li><a href="#premiers-graphes-ggplot2" id="toc-premiers-graphes-ggplot2" class="nav-link" data-scroll-target="#premiers-graphes-ggplot2"><span class="header-section-number">7.2.1</span> Premiers graphes <code>ggplot2</code></a></li>
  <li><a href="#data-et-aesthetics" id="toc-data-et-aesthetics" class="nav-link" data-scroll-target="#data-et-aesthetics"><span class="header-section-number">7.2.2</span> Data et aesthetics</a></li>
  <li><a href="#geometrics" id="toc-geometrics" class="nav-link" data-scroll-target="#geometrics"><span class="header-section-number">7.2.3</span> Geometrics</a></li>
  <li><a href="#statistics" id="toc-statistics" class="nav-link" data-scroll-target="#statistics"><span class="header-section-number">7.2.4</span> Statistics</a></li>
  <li><a href="#scales" id="toc-scales" class="nav-link" data-scroll-target="#scales"><span class="header-section-number">7.2.5</span> Scales</a></li>
  <li><a href="#group-et-facets" id="toc-group-et-facets" class="nav-link" data-scroll-target="#group-et-facets"><span class="header-section-number">7.2.6</span> Group et facets</a></li>
  </ul></li>
  <li><a href="#compléments" id="toc-compléments" class="nav-link" data-scroll-target="#compléments"><span class="header-section-number">7.3</span> Compléments</a></li>
  <li><a href="#quelques-exercices-supplémentaires" id="toc-quelques-exercices-supplémentaires" class="nav-link" data-scroll-target="#quelques-exercices-supplémentaires"><span class="header-section-number">7.4</span> Quelques exercices supplémentaires</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-ggplot.html">Visualisation</a></li><li class="breadcrumb-item"><a href="./07-ggplot.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualisation avec ggplot2</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ggplot2" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualisation avec ggplot2</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">

</div>
<style>
div.correction {
  color: black;
  background-color: #F0F0F0;
  font-style: normal;
  /*display: none;*/
}

.corR {
  font-style: italic;
  /*display: none;*/
}
</style>
<p>Il est souvent nécessaire d’utiliser des techniques de visualisation au cours des différentes étapes d’un projet en science des données. Un des avantages de <strong>R</strong> est qu’il est relativement simple de mettre en œuvre tous les types de graphes généralement utilisés. Dans cette partie, nous présentons tout d’abord les fonctions classiques qui permettent de tracer des figures. Nous proposons ensuite une introduction aux graphes <strong>ggplot</strong> qui sont de plus en plus utilisés pour faire de la visualisation.</p>
<section id="fonctions-graphiques-conventionnelles" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="fonctions-graphiques-conventionnelles"><span class="header-section-number">7.1</span> Fonctions graphiques conventionnelles</h2>
<p>Pour commencer il est intéressant d’examiner quelques exemples de représentations graphiques construits avec <strong>R</strong>. On peut les obtenir à l’aide de la fonction <strong>demo</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">demo</span>(graphics)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="la-fonction-plot" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="la-fonction-plot"><span class="header-section-number">7.1.1</span> La fonction <strong>plot</strong></h3>
<p>C’est une <strong>fonction générique</strong> que l’on peut utiliser pour représenter différents types de données. L’utilisation standard consiste à visualiser une variable <em>y</em> en fonction d’une variable <em>x</em>. On peut par exemple obtenir le graphe de la fonction <span class="math inline">\(x\mapsto \sin(2\pi x)\)</span> sur <span class="math inline">\([0,1]\)</span>, à l’aide de</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>pi,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">by=</span><span class="fl">0.05</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sin</span>(x)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y) <span class="co">#points (par défaut)</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y,<span class="at">type=</span><span class="st">"l"</span>) <span class="co">#représentation sous forme de ligne</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-3-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Nous proposons des exemples de représentations de variables quantitatives et qualitatives à travers du jeu de données <strong>ozone.txt</strong> que l’on importe avec</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ozone <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/ozone.txt"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ozone)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     maxO3              T9             T12             T15       
 Min.   : 42.00   Min.   :11.30   Min.   :14.00   Min.   :14.90  
 1st Qu.: 70.75   1st Qu.:16.20   1st Qu.:18.60   1st Qu.:19.27  
 Median : 81.50   Median :17.80   Median :20.55   Median :22.05  
 Mean   : 90.30   Mean   :18.36   Mean   :21.53   Mean   :22.63  
 3rd Qu.:106.00   3rd Qu.:19.93   3rd Qu.:23.55   3rd Qu.:25.40  
 Max.   :166.00   Max.   :27.00   Max.   :33.50   Max.   :35.50  
      Ne9             Ne12            Ne15           Vx9         
 Min.   :0.000   Min.   :0.000   Min.   :0.00   Min.   :-7.8785  
 1st Qu.:3.000   1st Qu.:4.000   1st Qu.:3.00   1st Qu.:-3.2765  
 Median :6.000   Median :5.000   Median :5.00   Median :-0.8660  
 Mean   :4.929   Mean   :5.018   Mean   :4.83   Mean   :-1.2143  
 3rd Qu.:7.000   3rd Qu.:7.000   3rd Qu.:7.00   3rd Qu.: 0.6946  
 Max.   :8.000   Max.   :8.000   Max.   :8.00   Max.   : 5.1962  
      Vx12             Vx15            maxO3v           vent          
 Min.   :-7.878   Min.   :-9.000   Min.   : 42.00   Length:112        
 1st Qu.:-3.565   1st Qu.:-3.939   1st Qu.: 71.00   Class :character  
 Median :-1.879   Median :-1.550   Median : 82.50   Mode  :character  
 Mean   :-1.611   Mean   :-1.691   Mean   : 90.57                     
 3rd Qu.: 0.000   3rd Qu.: 0.000   3rd Qu.:106.00                     
 Max.   : 6.578   Max.   : 5.000   Max.   :166.00                     
    pluie          
 Length:112        
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
</div>
<p>On visualise tout d’abord 2 variables quantitatives à l’aide d’un nuage de points : la concentration en ozone maximale <strong>maxO3</strong> en fonction de la température à 12h <strong>T12</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ozone[,<span class="st">"T12"</span>],ozone[,<span class="st">"maxO3"</span>])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Comme les deux variables appartiennent au même jeu de données, on peut obtenir la même représentation à l’aide d’une sytaxe plus claire qui ajoute automatiquement les noms des variables sur les axes :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(maxO3<span class="sc">~</span>T12,<span class="at">data=</span>ozone)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Une autre façon de faire (moins naturelle) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ozone[,<span class="st">"T12"</span>],ozone[,<span class="st">"maxO3"</span>],<span class="at">xlab=</span><span class="st">"T12"</span>,<span class="at">ylab=</span><span class="st">"maxO3"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Il existe des fonctions spécifiques pour chaque type de graphes, par exemple <strong>histogram</strong>, <strong>barplot</strong> et <strong>boxplot</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ozone<span class="sc">$</span>maxO3,<span class="at">main=</span><span class="st">"Histogram"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">table</span>(ozone<span class="sc">$</span>vent)<span class="sc">/</span><span class="fu">nrow</span>(ozone),<span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(maxO3<span class="sc">~</span>vent,<span class="at">data=</span>ozone)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-8-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="graphes-interactifs-avec-ramcharts" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="graphes-interactifs-avec-ramcharts"><span class="header-section-number">7.1.2</span> Graphes interactifs avec rAmCharts</h3>
<p>On peut utiliser ce package pour obtenir des graphes dynamiques. L’utilisation est relativement simple, il suffit d’ajouter le préfixe <strong>am</strong> devant le nom de la fonction :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rAmCharts)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">amHist</span>(ozone<span class="sc">$</span>maxO3)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-b3b5713b07ec1391394a" style="width:100%;height:500px;" class="ramcharts_base html-widget"></div>
<script type="application/json" data-for="htmlwidget-b3b5713b07ec1391394a">{"x":{"chartData":{"columnSpacing":0,"columnWidth":1,"fillAlphas":1,"lineAlpha":1,"categoryAxis":{"title":"ozone$maxO3"},"categoryField":"x","creditsPosition":"bottom-right","dataProvider":[{"x":50,"y":10,"cut":"(from 40 to 60)","color":"#1e90ff"},{"x":70,"y":43,"cut":"(from 60 to 80)","color":"#1e90ff"},{"x":90,"y":27,"cut":"(from 80 to 100)","color":"#1e90ff"},{"x":110,"y":16,"cut":"(from 100 to 120)","color":"#1e90ff"},{"x":130,"y":5,"cut":"(from 120 to 140)","color":"#1e90ff"},{"x":150,"y":10,"cut":"(from 140 to 160)","color":"#1e90ff"},{"x":170,"y":1,"cut":"(from 160 to 180)","color":"#1e90ff"}],"graphs":[{"animationPlayed":false,"fillAlphas":0.8,"lineAlpha":1,"fillColorsField":"color","lineColor":"#1e90ff","labelText":"","balloonText":"<b>[[value]]<\/b> <br/> [[cut]] ","type":"column","valueField":"y"}],"theme":"light","type":"serial","valueAxes":[{"minimum":0,"maximum":45.15,"title":"Frequency"}]},"background":"#ffffff","listeners":null,"axes_listeners":null,"axes_listenersIndices":null,"categoryAxis_listeners":null,"chartCursor_listeners":null,"dataSetSelector_listeners":null,"legend_listeners":null,"panels_listeners":null,"panels_listenersIndices":null,"periodSelector_listeners":null,"valueAxes_listeners":null,"valueAxes_listenersIndices":[],"stockLegend_listeners":null,"group":null,"is_ts_module":false},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">amPlot</span>(ozone,<span class="at">col=</span><span class="fu">c</span>(<span class="st">"T9"</span>,<span class="st">"T12"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-67dd48909cde58148eac" style="width:100%;height:500px;" class="ramcharts_base html-widget"></div>
<script type="application/json" data-for="htmlwidget-67dd48909cde58148eac">{"x":{"chartData":{"precision":2,"categoryAxis":{"title":"index","position":"bottom","id":"x"},"categoryField":"amCategory","dataProvider":[{"T9":15.6,"T12":18.5,"amCategory":"Obs. 1"},{"T9":17,"T12":18.4,"amCategory":"Obs. 2"},{"T9":15.3,"T12":17.6,"amCategory":"Obs. 3"},{"T9":16.2,"T12":19.7,"amCategory":"Obs. 4"},{"T9":17.4,"T12":20.5,"amCategory":"Obs. 5"},{"T9":17.7,"T12":19.8,"amCategory":"Obs. 6"},{"T9":16.8,"T12":15.6,"amCategory":"Obs. 7"},{"T9":14.9,"T12":17.5,"amCategory":"Obs. 8"},{"T9":16.1,"T12":19.6,"amCategory":"Obs. 9"},{"T9":18.3,"T12":21.9,"amCategory":"Obs. 10"},{"T9":17.3,"T12":19.3,"amCategory":"Obs. 11"},{"T9":17.6,"T12":20.3,"amCategory":"Obs. 12"},{"T9":18.3,"T12":19.6,"amCategory":"Obs. 13"},{"T9":17.1,"T12":18.2,"amCategory":"Obs. 14"},{"T9":15.4,"T12":17.4,"amCategory":"Obs. 15"},{"T9":15.9,"T12":19.1,"amCategory":"Obs. 16"},{"T9":21,"T12":24.6,"amCategory":"Obs. 17"},{"T9":16.2,"T12":22.4,"amCategory":"Obs. 18"},{"T9":19.7,"T12":24.2,"amCategory":"Obs. 19"},{"T9":23.6,"T12":28.6,"amCategory":"Obs. 20"},{"T9":20.4,"T12":25.2,"amCategory":"Obs. 21"},{"T9":27,"T12":32.7,"amCategory":"Obs. 22"},{"T9":24,"T12":23.5,"amCategory":"Obs. 23"},{"T9":19.7,"T12":22.9,"amCategory":"Obs. 24"},{"T9":20.1,"T12":22.4,"amCategory":"Obs. 25"},{"T9":19.6,"T12":25.1,"amCategory":"Obs. 26"},{"T9":19.5,"T12":23.4,"amCategory":"Obs. 27"},{"T9":18.8,"T12":22.7,"amCategory":"Obs. 28"},{"T9":24.1,"T12":28.4,"amCategory":"Obs. 29"},{"T9":26.6,"T12":30.1,"amCategory":"Obs. 30"},{"T9":19.5,"T12":18.8,"amCategory":"Obs. 31"},{"T9":16.8,"T12":18.2,"amCategory":"Obs. 32"},{"T9":20.8,"T12":23.7,"amCategory":"Obs. 33"},{"T9":17.5,"T12":18.2,"amCategory":"Obs. 34"},{"T9":18.1,"T12":21.2,"amCategory":"Obs. 35"},{"T9":19.2,"T12":22,"amCategory":"Obs. 36"},{"T9":19.4,"T12":20.7,"amCategory":"Obs. 37"},{"T9":19.2,"T12":21,"amCategory":"Obs. 38"},{"T9":13.8,"T12":17.3,"amCategory":"Obs. 39"},{"T9":14.3,"T12":14.5,"amCategory":"Obs. 40"},{"T9":15.6,"T12":18.6,"amCategory":"Obs. 41"},{"T9":16.9,"T12":19.1,"amCategory":"Obs. 42"},{"T9":17.4,"T12":20.4,"amCategory":"Obs. 43"},{"T9":15.1,"T12":20.5,"amCategory":"Obs. 44"},{"T9":15.1,"T12":15.6,"amCategory":"Obs. 45"},{"T9":16.7,"T12":19.1,"amCategory":"Obs. 46"},{"T9":16.9,"T12":20.3,"amCategory":"Obs. 47"},{"T9":18,"T12":21.6,"amCategory":"Obs. 48"},{"T9":18.6,"T12":21.9,"amCategory":"Obs. 49"},{"T9":18.8,"T12":22.5,"amCategory":"Obs. 50"},{"T9":19,"T12":22.5,"amCategory":"Obs. 51"},{"T9":19.9,"T12":26.9,"amCategory":"Obs. 52"},{"T9":23.8,"T12":27.7,"amCategory":"Obs. 53"},{"T9":24,"T12":28.3,"amCategory":"Obs. 54"},{"T9":23.3,"T12":27.6,"amCategory":"Obs. 55"},{"T9":25,"T12":29.6,"amCategory":"Obs. 56"},{"T9":24.9,"T12":30.5,"amCategory":"Obs. 57"},{"T9":20.5,"T12":26.3,"amCategory":"Obs. 58"},{"T9":25.3,"T12":29.5,"amCategory":"Obs. 59"},{"T9":21.3,"T12":23.8,"amCategory":"Obs. 60"},{"T9":20,"T12":18.2,"amCategory":"Obs. 61"},{"T9":18.7,"T12":20.6,"amCategory":"Obs. 62"},{"T9":18.6,"T12":18.7,"amCategory":"Obs. 63"},{"T9":19.2,"T12":23,"amCategory":"Obs. 64"},{"T9":19.9,"T12":21.6,"amCategory":"Obs. 65"},{"T9":18.7,"T12":21.4,"amCategory":"Obs. 66"},{"T9":18.4,"T12":17.1,"amCategory":"Obs. 67"},{"T9":17.1,"T12":20,"amCategory":"Obs. 68"},{"T9":17.8,"T12":22.8,"amCategory":"Obs. 69"},{"T9":20.9,"T12":25.2,"amCategory":"Obs. 70"},{"T9":18.8,"T12":20.5,"amCategory":"Obs. 71"},{"T9":23.5,"T12":29.8,"amCategory":"Obs. 72"},{"T9":20.8,"T12":23.7,"amCategory":"Obs. 73"},{"T9":18.8,"T12":21.1,"amCategory":"Obs. 74"},{"T9":17.8,"T12":21.3,"amCategory":"Obs. 75"},{"T9":20.6,"T12":24.8,"amCategory":"Obs. 76"},{"T9":21.6,"T12":26.9,"amCategory":"Obs. 77"},{"T9":22.7,"T12":28.4,"amCategory":"Obs. 78"},{"T9":19.8,"T12":27.2,"amCategory":"Obs. 79"},{"T9":25,"T12":33.5,"amCategory":"Obs. 80"},{"T9":20.1,"T12":22.9,"amCategory":"Obs. 81"},{"T9":21,"T12":26.3,"amCategory":"Obs. 82"},{"T9":21,"T12":24.4,"amCategory":"Obs. 83"},{"T9":16.9,"T12":17.8,"amCategory":"Obs. 84"},{"T9":17.5,"T12":18.6,"amCategory":"Obs. 85"},{"T9":16.5,"T12":20.3,"amCategory":"Obs. 86"},{"T9":17.7,"T12":20.2,"amCategory":"Obs. 87"},{"T9":17.3,"T12":22.7,"amCategory":"Obs. 88"},{"T9":15.3,"T12":16.8,"amCategory":"Obs. 89"},{"T9":15.9,"T12":19.2,"amCategory":"Obs. 90"},{"T9":16.2,"T12":18.9,"amCategory":"Obs. 91"},{"T9":18.3,"T12":18.3,"amCategory":"Obs. 92"},{"T9":16.9,"T12":20.8,"amCategory":"Obs. 93"},{"T9":17.3,"T12":19.8,"amCategory":"Obs. 94"},{"T9":14.2,"T12":22.2,"amCategory":"Obs. 95"},{"T9":15.8,"T12":18.7,"amCategory":"Obs. 96"},{"T9":15.2,"T12":17.9,"amCategory":"Obs. 97"},{"T9":17.1,"T12":17.7,"amCategory":"Obs. 98"},{"T9":15.4,"T12":17.7,"amCategory":"Obs. 99"},{"T9":13.7,"T12":14,"amCategory":"Obs. 100"},{"T9":12.7,"T12":14.3,"amCategory":"Obs. 101"},{"T9":14.8,"T12":16.3,"amCategory":"Obs. 102"},{"T9":15.5,"T12":18,"amCategory":"Obs. 103"},{"T9":11.3,"T12":19.4,"amCategory":"Obs. 104"},{"T9":15.2,"T12":19.7,"amCategory":"Obs. 105"},{"T9":14.7,"T12":17.6,"amCategory":"Obs. 106"},{"T9":13.3,"T12":17.7,"amCategory":"Obs. 107"},{"T9":13.3,"T12":17.7,"amCategory":"Obs. 108"},{"T9":16.2,"T12":20.8,"amCategory":"Obs. 109"},{"T9":16.9,"T12":23,"amCategory":"Obs. 110"},{"T9":16.9,"T12":19.8,"amCategory":"Obs. 111"},{"T9":15.7,"T12":18.6,"amCategory":"Obs. 112"}],"graphs":[{"animationPlayed":false,"lineAlpha":1,"bullet":"round","fill_alphas":0,"bulletAlpha":0,"maxBulletSize":0,"balloonText":"value: <b>[[value]]<\/b>","title":"T9","type":"line","valueField":"T9"},{"animationPlayed":false,"lineAlpha":1,"bullet":"round","fill_alphas":0,"bulletAlpha":0,"maxBulletSize":0,"balloonText":"value: <b>[[value]]<\/b>","title":"T12","type":"line","valueField":"T12"}],"type":"serial","valueAxes":[{"position":"left","id":"y","title":"ozone"}]},"background":"#ffffff","listeners":null,"axes_listeners":null,"axes_listenersIndices":null,"categoryAxis_listeners":null,"chartCursor_listeners":null,"dataSetSelector_listeners":null,"legend_listeners":null,"panels_listeners":null,"panels_listenersIndices":null,"periodSelector_listeners":null,"valueAxes_listeners":null,"valueAxes_listenersIndices":[],"stockLegend_listeners":null,"group":null,"is_ts_module":false},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">amBoxplot</span>(maxO3<span class="sc">~</span>vent,<span class="at">data=</span>ozone)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="htmlwidget-fe5fb92e3bd42997fc77" style="width:100%;height:500px;" class="ramcharts_base html-widget"></div>
<script type="application/json" data-for="htmlwidget-fe5fb92e3bd42997fc77">{"x":{"chartData":{"rotate":false,"categoryField":"cat","dataProvider":[{"cat":"Est","low_outlier":92,"low":92,"open":96,"median":109,"close":121,"high":146,"high_outlier":146,"color":"#1e90ff","real_outlier_1":"45","individual_1":"<b> Individual <\/b>: 40"},{"cat":"Nord","low_outlier":42,"low":42,"open":71,"median":81,"close":94.5,"high":121,"high_outlier":121,"color":"#1e90ff","real_outlier_1":"153","individual_1":"<b> Individual <\/b>: 53","real_outlier_2":"159","individual_2":"<b> Individual <\/b>: 54"},{"cat":"Ouest","low_outlier":55,"low":55,"open":67,"median":76,"close":88,"high":113,"high_outlier":113,"color":"#1e90ff","real_outlier_1":"131","individual_1":"<b> Individual <\/b>: 78","real_outlier_2":"145","individual_2":"<b> Individual <\/b>: 17","real_outlier_3":"149","individual_3":"<b> Number of outliers <\/b>: 2","real_outlier_4":"156","individual_4":"<b> Individual <\/b>: 57","real_outlier_5":"166","individual_5":"<b> Individual <\/b>: 79"},{"cat":"Sud","low_outlier":54,"low":54,"open":81,"median":99,"close":116,"high":160,"high_outlier":160,"color":"#1e90ff"}],"graphs":[{"animationPlayed":false,"id":"g1","closeField":"close","fillColorsField":"color","highField":"high","lineColor":"#7f8da9","lineAlpha":1,"lowField":"low","fillAlphas":"0.9","negativeLineColor":"#7f8da9","openField":"open","columnWidth":0.4,"balloonText":"High = <b>[[high_outlier]]<\/b><br/>3rd quart. = <b>[[close]]<\/b><br/>Median = <b>[[median]]<\/b><br/>1st quart. = <b>[[open]]<\/b><br/>Low = <b>[[low_outlier]]<\/b><br/>","title":"Price:","type":"candlestick","valueField":"close"},{"animationPlayed":false,"id":"g2","lineColor":"black","noStepRisers":true,"lineThickness":3,"periodSpan":0.4,"balloonText":"","type":"step","valueField":"median"},{"animationPlayed":false,"id":"g3","lineColor":"black","noStepRisers":true,"periodSpan":0.3,"balloonText":"","type":"step","valueField":"low_outlier"},{"animationPlayed":false,"id":"g4","lineColor":"black","noStepRisers":true,"periodSpan":0.3,"balloonText":"","type":"step","valueField":"high_outlier"},{"animationPlayed":false,"id":"g5","lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"","type":"line","valueField":"real_outlier"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_1]]<br/><b> Value <\/b>: [[real_outlier_1]]","type":"line","valueField":"real_outlier_1"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_2]]<br/><b> Value <\/b>: [[real_outlier_2]]","type":"line","valueField":"real_outlier_2"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_3]]<br/><b> Value <\/b>: [[real_outlier_3]]","type":"line","valueField":"real_outlier_3"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_4]]<br/><b> Value <\/b>: [[real_outlier_4]]","type":"line","valueField":"real_outlier_4"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_5]]<br/><b> Value <\/b>: [[real_outlier_5]]","type":"line","valueField":"real_outlier_5"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_6]]<br/><b> Value <\/b>: [[real_outlier_6]]","type":"line","valueField":"real_outlier_6"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_7]]<br/><b> Value <\/b>: [[real_outlier_7]]","type":"line","valueField":"real_outlier_7"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_8]]<br/><b> Value <\/b>: [[real_outlier_8]]","type":"line","valueField":"real_outlier_8"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_9]]<br/><b> Value <\/b>: [[real_outlier_9]]","type":"line","valueField":"real_outlier_9"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_10]]<br/><b> Value <\/b>: [[real_outlier_10]]","type":"line","valueField":"real_outlier_10"},{"animationPlayed":false,"lineColor":"black","lineAlpha":0,"bullet":"round","noStepRisers":true,"periodSpan":0.5,"balloonText":"[[individual_11]]<br/><b> Value <\/b>: [[real_outlier_11]]","type":"line","valueField":"real_outlier_11"}],"theme":"light","type":"serial"},"background":"#ffffff","listeners":null,"axes_listeners":null,"axes_listenersIndices":null,"categoryAxis_listeners":null,"chartCursor_listeners":null,"dataSetSelector_listeners":null,"legend_listeners":null,"panels_listeners":null,"panels_listenersIndices":null,"periodSelector_listeners":null,"valueAxes_listeners":null,"valueAxes_listenersIndices":null,"stockLegend_listeners":null,"group":null,"is_ts_module":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="quelques-exercices" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="quelques-exercices"><span class="header-section-number">7.1.3</span> Quelques exercices</h3>
<div id="exr-exo1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.1 (Premier graphe)</strong></span> On s’intéresse à quelques graphes simples.</p>
<ol type="1">
<li><p>Tracer la fonction <strong>sinus</strong> entre <span class="math inline">\(0\)</span> et <span class="math inline">\(2\pi\)</span>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">sin</span>(x),<span class="at">type=</span><span class="st">"l"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>A l’aide de la fonction <strong>title</strong> ajouter le titre <strong>Représentation de la fonction sinus</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"Représentation de la fonction sinus"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ol>
</div>
<div id="exr-exo2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.2 (Tracé de densités)</strong></span> On souhaite ici visualiser et comparer des densités de probabilité.</p>
<ol type="1">
<li><p>Tracer la densité de la loi normale centrée réduite entre <span class="math inline">\(-4\)</span> et 4 (utiliser <strong>dnorm</strong>).</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="at">by=</span><span class="fl">0.01</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">dnorm</span>(x),<span class="at">type=</span><span class="st">"l"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Ajouter une ligne verticale (en tirets) qui passe par <span class="math inline">\(x=0\)</span> (utiliser <strong>abline</strong> avec l’option <strong>lty=2</strong>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>,<span class="at">lty=</span><span class="dv">2</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Sur le même graphe, ajouter les densités de loi la de Student à 5 et 30 degrés de liberté (utiliser <strong>dt</strong>). On utilisera la fonction <strong>lines</strong> et des couleurs différentes pour chaque densité.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">dt</span>(x,<span class="dv">5</span>),<span class="at">col=</span><span class="dv">2</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">dt</span>(x,<span class="dv">30</span>),<span class="at">col=</span><span class="dv">3</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Ajouter une légende qui permette d’identifier chaque densité (fonction <strong>legend</strong>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Normal"</span>,<span class="st">"Student(5)"</span>,<span class="st">"Student(30)"</span>),</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>   <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,<span class="at">lty=</span><span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ol>
</div>
<div id="exr-exo3" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.3 (Tâches solaires)</strong></span> On souhaite ici visualiser une série temporelle.</p>
<ol type="1">
<li><p>Importer la série <strong>taches_solaires.csv</strong> qui donne, date par date, un nombre de taches solaires observées.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>taches <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/taches_solaires.csv"</span>,<span class="at">sep=</span><span class="st">";"</span>,<span class="at">header=</span><span class="cn">TRUE</span>,<span class="at">dec=</span><span class="st">","</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>A l’aide de la fonction <strong>cut_interval</strong> du package <code>ggplot2</code>, créer un facteur qui sépare l’intervalle d’années d’observation en 8 intervalles de tailles à peu près égales. On appellera <strong>periode</strong> ce facteur.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>periode <span class="ot">&lt;-</span> ggplot2<span class="sc">::</span><span class="fu">cut_interval</span>(taches<span class="sc">$</span>annee,<span class="at">n=</span><span class="dv">8</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Utiliser les levels suivants pour le facteur <strong>periode</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>couleurs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"yellow"</span>, <span class="st">"magenta"</span>, <span class="st">"orange"</span>, <span class="st">"cyan"</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>          <span class="st">"grey"</span>, <span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(periode) <span class="ot">&lt;-</span> couleurs</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Expliquer la sortie de la fonction</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>coordx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">along=</span>taches[,<span class="dv">1</span>])</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="corR">
<p>On crée une séquence avec un pas de 1 de longueur égale à la dimension de <code>taches[,1]</code>.</p>
</div></li>
<li><p>Visualiser la série du nombre de taches en utilisant une couleur différente pour chaque période.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(coordx,taches[,<span class="dv">1</span>],<span class="at">xlab=</span><span class="st">"Temps"</span>,<span class="at">ylab=</span><span class="st">"Nombre de taches"</span>,</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a> <span class="at">col=</span>periode,<span class="at">type=</span><span class="st">"p"</span>,<span class="at">pch=</span><span class="st">"+"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ol>
</div>
<div id="exr-exo4" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.4 (Layout)</strong></span> On reprend le jeu de données sur l’ozone. A l’aide de la fonction <strong>layout</strong> séparer la fenêtre graphique en deux lignes avec</p>
<ul>
<li><p>un graphe sur la première ligne (nuage de points <strong>maxO3 vs T12</strong>)</p></li>
<li><p>2 graphes sur la deuxième ligne (histogramme de <strong>T12</strong> et boxplot de <strong>maxO3</strong>).</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">layout</span>(<span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">2</span>, <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(maxO3<span class="sc">~</span>T12,<span class="at">data=</span>ozone)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ozone<span class="sc">$</span>T12)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(ozone<span class="sc">$</span>maxO3)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ul>
</div>
</section>
</section>
<section id="la-grammaire-ggplot2" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="la-grammaire-ggplot2"><span class="header-section-number">7.2</span> La grammaire <strong>ggplot2</strong></h2>
<p>Ce package propose de définir des graphes sur <strong>R</strong> en utilisant une <strong>grammaire des graphiques</strong> (tout comme <strong>dplyr</strong> pour manipuler les données). On peut trouver de la documentation sur ce package aux url <a href="https://ggplot2.tidyverse.org" class="uri">https://ggplot2.tidyverse.org</a> et <a href="https://ggplot2-book.org/index.html" class="uri">https://ggplot2-book.org/index.html</a></p>
<section id="premiers-graphes-ggplot2" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="premiers-graphes-ggplot2"><span class="header-section-number">7.2.1</span> Premiers graphes <code>ggplot2</code></h3>
<p>Nous considérons un sous échantillon du jeu de données <code>diamonds</code> du package <strong>ggplot2</strong> (que l’on peut également charger avec le package <strong>tidyverse</strong>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>diamonds2 <span class="ot">&lt;-</span> diamonds[<span class="fu">sample</span>(<span class="fu">nrow</span>(diamonds),<span class="dv">5000</span>),] </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diamonds2)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     carat               cut       color       clarity         depth      
 Min.   :0.2000   Fair     : 158   D: 640   SI1    :1189   Min.   :43.00  
 1st Qu.:0.4000   Good     : 455   E: 916   VS2    :1157   1st Qu.:61.10  
 Median :0.7000   Very Good:1094   F: 900   SI2    : 876   Median :61.80  
 Mean   :0.7969   Premium  :1280   G:1018   VS1    : 738   Mean   :61.76  
 3rd Qu.:1.0400   Ideal    :2013   H: 775   VVS2   : 470   3rd Qu.:62.50  
 Max.   :4.1300                    I: 481   VVS1   : 326   Max.   :71.60  
                                   J: 270   (Other): 244                  
     table           price             x                y        
 Min.   :49.00   Min.   :  365   Min.   : 0.000   Min.   :3.720  
 1st Qu.:56.00   1st Qu.:  945   1st Qu.: 4.720   1st Qu.:4.720  
 Median :57.00   Median : 2376   Median : 5.690   Median :5.700  
 Mean   :57.43   Mean   : 3917   Mean   : 5.728   Mean   :5.731  
 3rd Qu.:59.00   3rd Qu.: 5294   3rd Qu.: 6.530   3rd Qu.:6.520  
 Max.   :95.00   Max.   :18757   Max.   :10.000   Max.   :9.850  
                                                                 
       z        
 Min.   :0.000  
 1st Qu.:2.920  
 Median :3.520  
 Mean   :3.538  
 3rd Qu.:4.030  
 Max.   :6.430  
                </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help</span>(diamonds)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Un graphe <strong>ggplot</strong> est défini à partir de <strong>couches</strong> que l’on assemblera avec l’opérateur <code>+</code>. Il faut a minima spécifier :</p>
<ul>
<li>les données</li>
<li>les variables que l’on souhaite représenter</li>
<li>le type de représentation (nuage de points, boxplot…).</li>
</ul>
<p>Il existe un verbe pour définir chacune de ces couches :</p>
<ul>
<li><strong>ggplot</strong> pour les données</li>
<li><strong>aes</strong> (aesthetics) pour les variables</li>
<li><strong>geom_</strong> pour le type de représentation.</li>
</ul>
<p>On peut obtenir le nuage de points <strong>carat vs price</strong> avec la fonction <strong>plot</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(price<span class="sc">~</span>carat,<span class="at">data=</span>diamonds2)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Avec <strong>ggplot</strong>, on va faire</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2) <span class="co">#rien</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price) <span class="co">#rien</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-29-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_point</span>() <span class="co">#bon</span></span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-29-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div id="exr-exoggplot1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.5 (Premiers graphes ggplot)</strong></span> <br>
</p>
<ol type="1">
<li><p>Tracer l’histogramme de la variable <code>carat</code> (utiliser <code>geom_histogram</code>).</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat)<span class="sc">+</span><span class="fu">geom_histogram</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Même question en utilisant 10 classes pour l’histogramme (<strong>help(geom_histogram)</strong>).</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Tracer le diagramme en barres de la variable <code>cut</code> (utiliser <strong>geom_bar</strong>).</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut)<span class="sc">+</span><span class="fu">geom_bar</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ol>
</div>
<p>La syntaxe <strong>ggplot</strong> est définie à partir d’éléments indépendants qui définissent la grammaire de <strong>ggplot</strong>. Les principaux verbes sont :</p>
<ul>
<li><strong>Data</strong> (<code>ggplot</code>) : les données au format <strong>dataframe</strong> ou <strong>tibble</strong></li>
<li><strong>Aesthetics</strong> (<code>aes</code>) : pour sépecifier les variables à représenter dans le graphe.</li>
<li><strong>Geometrics</strong> (<code>geom_...</code>) : le type de graphe (nuage de points, histogramme…).</li>
<li><strong>Statistics</strong> (<code>stat_...</code>) : utile pour spécifier des transformations des données nécessaires pour obtenir le graphe.</li>
<li><strong>Scales</strong> (<code>scale_...</code>) : pour controler les paramètres permettant d’affiner le graphe (changement de couleurs, paramètres des axes…).</li>
</ul>
<p>Tous ces éléments sont reliés avec le symbole <strong>+</strong>.</p>
</section>
<section id="data-et-aesthetics" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="data-et-aesthetics"><span class="header-section-number">7.2.2</span> Data et aesthetics</h3>
<p>Ces deux verbes sont à utiliser pour tous les graphes <strong>ggplot</strong>. Le verbe <code>ggplot</code> sert à spécifier le jeu de données que l’on souhaite utiliser. Si le code est bien fait, nous n’aurons plus à utiliser le nom du jeu de données par la suite pour construire le graphe. Le verbe <code>aes</code> est quant à lui utile pour spécifier les variables que l’on souhaite visualiser. Par exemple, pour le nuage de points <strong>price vs carat</strong> la syntaxe débute avec</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Les variables peuvent également être utilisées pour colorier des points ou des barres, définir des tailles… Dans ce cas on pourra renseigner les options <strong>color</strong>, <strong>size</strong>, <strong>fill</strong> dans la fonction <code>aes</code>. Par exemple</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price,<span class="at">color=</span>cut)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="geometrics" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="geometrics"><span class="header-section-number">7.2.3</span> Geometrics</h3>
<p>Ce verbe décrira le type de représentation souhaité. Pour un nuage de points, on utilisera par exemple <strong>geom_point</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price,<span class="at">color=</span>cut)<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>On observe que <strong>ggplot</strong> ajoute la légende automatiquement. Voici les principaux exemples de <strong>geometrics</strong> :</p>
<div id="tbl-geom" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-geom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.1: Principaux geometrics
</figcaption>
<div aria-describedby="tbl-geom-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<colgroup>
<col style="width: 26%">
<col style="width: 37%">
<col style="width: 36%">
</colgroup>
<thead>
<tr class="header">
<th>Geom</th>
<th>Description</th>
<th>Aesthetics</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>geom_point()</td>
<td>nuage de points</td>
<td>x, y, shape, fill</td>
</tr>
<tr class="even">
<td>geom_line()</td>
<td>Ligne (ordonnée selon x)</td>
<td>x, y, linetype</td>
</tr>
<tr class="odd">
<td>geom_abline()</td>
<td>Ligne</td>
<td>slope, intercept</td>
</tr>
<tr class="even">
<td>geom_path()</td>
<td>Ligne (ordonnée par l’index)</td>
<td>x, y, linetype</td>
</tr>
<tr class="odd">
<td>geom_text()</td>
<td>Texte</td>
<td>x, y, label, hjust, vjust</td>
</tr>
<tr class="even">
<td>geom_rect()</td>
<td>Rectangle</td>
<td>xmin, xmax, ymin, ymax, fill, linetype</td>
</tr>
<tr class="odd">
<td>geom_polygon()</td>
<td>Polygone</td>
<td>x, y, fill, linetype</td>
</tr>
<tr class="even">
<td>geom_segment()</td>
<td>Segment</td>
<td>x, y, xend, yend, fill, linetype</td>
</tr>
<tr class="odd">
<td>geom_bar()</td>
<td>Diagramme en barres</td>
<td>x, fill, linetype, weight</td>
</tr>
<tr class="even">
<td>geom_histogram()</td>
<td>Histogramme</td>
<td>x, fill, linetype, weight</td>
</tr>
<tr class="odd">
<td>geom_boxplot()</td>
<td>Boxplot</td>
<td>x, fill, weight</td>
</tr>
<tr class="even">
<td>geom_density()</td>
<td>Densité</td>
<td>x, y, fill, linetype</td>
</tr>
<tr class="odd">
<td>geom_contour()</td>
<td>Lignes de contour</td>
<td>x, y, fill, linetype</td>
</tr>
<tr class="even">
<td>geom_smooth()</td>
<td>Lisseur (linéaire ou non linéaire)</td>
<td>x, y, fill, linetype</td>
</tr>
<tr class="odd">
<td>Tous</td>
<td></td>
<td>color, size, group</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<div id="exr-exoggplot2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.6 (Diagrammes en barres)</strong></span> On étudie différentes façons de changer la couleur dans un diagramme en barres.</p>
<ol type="1">
<li><p>Tracer le diagramme en barres de la variable <strong>cut</strong> avec des barres bleues.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"blue"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Tracer le diagramme en barres de la variable <strong>cut</strong> avec une couleur pour chaque modalité de <strong>cut</strong> ainsi qu’une légende qui permet de repérer la couleur.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut,<span class="at">fill=</span>cut)<span class="sc">+</span><span class="fu">geom_bar</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Tracer le diagramme en barres de la variable <strong>cut</strong> avec une couleur pour chaque modalité que vous choisirez (et sans légende).</p>
<div class="corR">
<p>On peut ajouter l’option <code>show.legend = FALSE</code> dans <strong>geom_bar</strong> :</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut,<span class="at">fill=</span>cut)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="corR">
<p>et changer les couleurs avec les fonctions <strong>scale_</strong>*</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut,<span class="at">fill=</span>cut)<span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"Fair"</span><span class="ot">=</span><span class="st">"blue"</span>,<span class="st">"Good"</span><span class="ot">=</span><span class="st">"red"</span>,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Very Good"</span><span class="ot">=</span><span class="st">"green"</span>,<span class="st">"Premium"</span><span class="ot">=</span><span class="st">"yellow"</span>,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">"Ideal"</span><span class="ot">=</span><span class="st">"black"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="corR">
<p>ou spécifier directement les couleurs (toujours dans <strong>geom_bar</strong>) :</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="fu">c</span>(<span class="st">"blue"</span>,<span class="st">"red"</span>,<span class="st">"green"</span>,<span class="st">"yellow"</span>,<span class="st">"black"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ol>
</div>
</section>
<section id="statistics" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="statistics"><span class="header-section-number">7.2.4</span> Statistics</h3>
<p>Certains graphes nécessitent des calculs d’indicateurs statistiques pour être tracé. C’est par exemple le cas pour le diagramme en barres et l’histogramme où il faut calculer des hauteurs de rectangles ou barres. On peut spécifier les transformations simples facilement, par exemple</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>pi,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">by=</span><span class="fl">0.01</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span><span class="fu">sin</span>(X))<span class="sc">+</span><span class="fu">geom_line</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>La transformation est spécifiée dans la fonction <code>aes</code>. Pour des transformations plus complexes, nous devons utiliser le verbe <strong>statistics</strong>. Une fonction <strong>stat_</strong> permet de définir des nouvelles variables à partir du jeu de données initial, il est ensuite possible de représenter ces nouvelles variables. Par exemple, la fonction <strong>stat_bin</strong>, qui est utilisée par défaut pour construire des histogrammes, calcule les variables suivantes :</p>
<ul>
<li><code>count</code>, le nombre d’observations dans chaque classes.</li>
<li><code>density</code>, la valeur de la densité des observations dans chaque classe (fréqunce divisée par largeur de la classe).</li>
<li><code>x</code>, le centre de la classe.</li>
</ul>
<p>Par défaut <strong>geom_histogram</strong> fait appel à cette fonction <code>stat_bin</code> grâce à l’option <code>stat="bin"</code>. On visualise ainsi sur l’axe <span class="math inline">\(y\)</span> le nombre d’observations dans chaque classe (la variable <strong>count</strong>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>price)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">40</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Si on souhaite une autre variable issue de <code>stat_bin</code>, comme par exemple la densité, il faudra utiliser</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>price,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">40</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Les fonctions <strong>stat_</strong> peuvent être utilisées à la place des <strong>geom_</strong> pour certaines représentations. Chaque fonction <strong>stat_</strong> possède par défaut un <strong>geom_</strong> et réciproquement. On peut par exemple obtenir le même graphe que précédemment avec</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>price,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">stat_bin</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Voici quelques exemple de fonctions <strong>stat_</strong></p>
<div id="tbl-ggplot-stat" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-ggplot-stat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.2: Exemple de statistics
</figcaption>
<div aria-describedby="tbl-ggplot-stat-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>Stat</th>
<th>Description</th>
<th>Paramètres</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>stat_identity()</td>
<td>aucune transformation</td>
<td></td>
</tr>
<tr class="even">
<td>stat_bin()</td>
<td>Count</td>
<td>binwidth, origin</td>
</tr>
<tr class="odd">
<td>stat_density()</td>
<td>Density</td>
<td>adjust, kernel</td>
</tr>
<tr class="even">
<td>stat_smooth()</td>
<td>Smoother</td>
<td>method, se</td>
</tr>
<tr class="odd">
<td>stat_boxplot()</td>
<td>Boxplot</td>
<td>coef</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p><em>stat</em> et <em>geom</em> ne sont pas toujours simples à combiner. Nous recommandons d’utiliser <strong>geom</strong> lorsqu’on débute avec <strong>ggplot</strong>, les <code>statistics</code>par défaut ne doivent en effet être changés que rarement.</p>
<div id="exr-exo-stat1" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.7 (Diagramme en barres “très simple”…)</strong></span> On considère une variable qualitative <span class="math inline">\(X\)</span> dont la loi est donnée par <span class="math display">\[P(X=\text{red})=0.3,\ P(X=\text{blue})=0.2,\ P(X=\text{green})=0.4,\ P(X=\text{black})=0.1\]</span> Représenter cette distribution de probabilité avec un diagramme en barres.</p>
<div class="corR">
<p>La difficulté ici vient du fait que les hauteurs de barre sont données : il ne faut pas les calculer à partir des données. On n’a donc pas à utiliser <strong>stat_count</strong> de <strong>geom_bar</strong>, if faut faire appel à <strong>stat_identity</strong>:</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">var=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>,<span class="st">"green"</span>,<span class="st">"black"</span>),<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span>))</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>var,<span class="at">y=</span>prob)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">""</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="corR">
<p>On peut aussi utiliser l’<strong>aes</strong> <code>weight</code> :</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>var,<span class="at">weight=</span>prob)<span class="sc">+</span><span class="fu">geom_bar</span>()<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">"prob"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="exr-exo-stat2" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.8 (Lissage)</strong></span> On étudie différentes façons de visualiser un lissage.</p>
<ol type="1">
<li><p>Représenter le lissage non linéaire de la variable <code>price</code> contre la variable <code>carat</code> à l’aide de <code>geom_smooth</code> puis de <code>stat_smooth</code>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-47-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Même question mais avec une ligne en pointillés à la place d’un trait plein.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">linetype=</span><span class="st">"dotted"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">stat_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>,<span class="at">geom=</span><span class="st">"point"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-48-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ol>
</div>
</section>
<section id="scales" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="scales"><span class="header-section-number">7.2.5</span> Scales</h3>
<p>Les échelles (<strong>scales</strong>) controlent tout un tas d’options telles que des changements de couleurs, d’échelles ou de limites d’axes, de symboles, etc… L’utilisation n’est pas simple et nécessite de la pratique. On utilise généralement ce verbe à la dernière étape de construction du graphe. La syntaxe est définie comme suit :</p>
<ul>
<li>début : <code>scale_</code>.</li>
<li>ajout de l’aesthetics que l’on souhaite modifier (<code>color_</code>, <code>fill_</code>, <code>x_</code>).</li>
<li>fin : nom de l’échelle (<code>manual</code>, <code>identity</code>…)</li>
</ul>
<p>Par exemple,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price,<span class="at">color=</span>cut)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"Fair"</span><span class="ot">=</span><span class="st">"black"</span>,<span class="st">"Good"</span><span class="ot">=</span><span class="st">"yellow"</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                              <span class="st">"Very Good"</span><span class="ot">=</span><span class="st">"blue"</span>,<span class="st">"Premium"</span><span class="ot">=</span><span class="st">"red"</span>,<span class="st">"Ideal"</span><span class="ot">=</span><span class="st">"green"</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Voici quelques exemples des principales échelles :</p>
<div id="tbl-scales" class="quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-scales-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.3: Exemples d’échelles
</figcaption>
<div aria-describedby="tbl-scales-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table">
<thead>
<tr class="header">
<th>aes</th>
<th>Discret</th>
<th>Continu</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Couleur (color et fill)</td>
<td>brewer</td>
<td>gradient</td>
</tr>
<tr class="even">
<td>-</td>
<td>grey</td>
<td>gradient2</td>
</tr>
<tr class="odd">
<td>-</td>
<td>hue</td>
<td>gradientn</td>
</tr>
<tr class="even">
<td>-</td>
<td>identity</td>
<td></td>
</tr>
<tr class="odd">
<td>-</td>
<td>manual</td>
<td></td>
</tr>
<tr class="even">
<td>Position (x et y)</td>
<td>discrete</td>
<td>continous</td>
</tr>
<tr class="odd">
<td>-</td>
<td></td>
<td>date</td>
</tr>
<tr class="even">
<td>Forme</td>
<td>shape</td>
<td></td>
</tr>
<tr class="odd">
<td>-</td>
<td>identity</td>
<td></td>
</tr>
<tr class="even">
<td>-</td>
<td>manual</td>
<td></td>
</tr>
<tr class="odd">
<td>Taille</td>
<td>identity</td>
<td>size</td>
</tr>
<tr class="even">
<td>-</td>
<td>manual</td>
<td></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Nous présentons quelques exemples d’utilisation des échelles :</p>
<ul>
<li><p><strong>Couleur dans un diagramme en barres</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cut)<span class="sc">+</span><span class="fu">geom_bar</span>(<span class="fu">aes</span>(<span class="at">fill=</span>cut))</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>p1</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>On change la couleur en utilisant la palette <strong>Purples</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>p1<span class="sc">+</span><span class="fu">scale_fill_brewer</span>(<span class="at">palette=</span><span class="st">"Purples"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p><strong>Gradient de couleurs pour un nuage de points</strong> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>depth))</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>p2</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>On change le gradient de couleur</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>p2<span class="sc">+</span><span class="fu">scale_color_gradient</span>(<span class="at">low=</span><span class="st">"red"</span>,<span class="at">high=</span><span class="st">"yellow"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p><strong>Modifications sur les axes</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>p2<span class="sc">+</span><span class="fu">scale_x_continuous</span>(<span class="at">breaks=</span><span class="fu">seq</span>(<span class="fl">0.5</span>,<span class="dv">3</span>,<span class="at">by=</span><span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">name=</span><span class="st">"prix"</span>)<span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_gradient</span>(<span class="st">"Profondeur"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ul>
</section>
<section id="group-et-facets" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="group-et-facets"><span class="header-section-number">7.2.6</span> Group et facets</h3>
<p><strong>ggplot</strong> permet de faire des représentations pour des groupes d’individus. On procède généralement de deux façons différentes :</p>
<ul>
<li>visualisation de sous groupes sur le même graphe, on utilise l’option <code>group</code> dans le verbe <strong>aes</strong> ;</li>
<li>visualisation de sous groupes sur des graphes différents, on utilise le verbe <strong>facet_wrap</strong> ou <strong>facet_grid</strong>.</li>
</ul>
<p>Représentons ici (sur le même graphe) le lisseur <strong>price vs carat</strong> pour chaque modalité de <em>cut</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price,<span class="at">group=</span>cut)<span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pour obtenir cette représentation sur plusieurs fenêtres, on utilise</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>)<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>cut)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"loess"</span>)<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>cut,<span class="at">nrow=</span><span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-56-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><strong>facet_grid</strong> et <strong>facet_wrap</strong> font des choses proches mais divisent la fenêtre d’une façon différente :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)<span class="sc">+</span><span class="fu">facet_grid</span>(color<span class="sc">~</span>cut)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)<span class="sc">+</span><span class="fu">facet_wrap</span>(color<span class="sc">~</span>cut)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-57-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="compléments" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="compléments"><span class="header-section-number">7.3</span> Compléments</h2>
<p>La syntaxe <strong>ggplot</strong> est définie selon le schéma :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">aes</span>()<span class="sc">+</span><span class="fu">geom_</span>()<span class="sc">+</span><span class="fu">scale_</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Elle est très flexible, on peut par exemple spécifier les variables de <code>aes</code> dans les verbes <code>ggplot</code> ou <code>geom_</code> :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price)<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2,<span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-59-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-59-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Ceci peut se révéler très utile lorsqu’on utilise des <strong>aes</strong> différents dans les <strong>geom_</strong>.</p>
<p>On peut aussi construire un graphe à l’aide de différents jeux de données :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>pi,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">by=</span><span class="fl">0.001</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>Y1 <span class="ot">&lt;-</span> <span class="fu">cos</span>(X)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>Y2 <span class="ot">&lt;-</span> <span class="fu">sin</span>(X)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>donnees1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,Y1)</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>donnees2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(X,Y2)</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(donnees1)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y1))<span class="sc">+</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>donnees2,<span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y2),<span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Il existe d’autres fonctions <strong>ggplot</strong> :</p>
<ul>
<li><strong>ggtitle</strong> pour ajouter un titre.</li>
<li><strong>ggsave</strong> pour sauver un graphe.</li>
<li><strong>theme_</strong> pour changer le theme du graphe.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(diamonds2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>price,<span class="at">color=</span>cut)<span class="sc">+</span><span class="fu">geom_point</span>()</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">theme_classic</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-61-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">theme_grey</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-61-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>p<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-61-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>D’autres thèmes sont disponibles dans le package <strong>ggtheme</strong>. On pourra également parler de la fonction <code>set_theme</code> qui permet de modifier le thème par défaut pour un document <strong>quarto</strong>.</p>
</section>
<section id="quelques-exercices-supplémentaires" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="quelques-exercices-supplémentaires"><span class="header-section-number">7.4</span> Quelques exercices supplémentaires</h2>
<div id="exr-exo-cos-sin" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.9 (Fonctions cosinus et sinus)</strong></span> L’objectif est de visualiser les fonctions <strong>sinus</strong> et <strong>cosinus</strong> de plusieurs façons.</p>
<ol type="1">
<li><p>Tracer les fonctions sinus et cosinus. On utilisera tout d’abord les deux jeux de données suivants (un pour le sinus, l’autre pour le cosinus) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>donnees1 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>pi,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">by=</span><span class="fl">0.001</span>),</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cos=</span><span class="fu">cos</span>(X))</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>donnees2 <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>pi,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">by=</span><span class="fl">0.001</span>),</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">sin=</span><span class="fu">sin</span>(X))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(donnees1)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>cos))<span class="sc">+</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data=</span>donnees2,<span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>sin),<span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Faire la même chose avec le jeu de données suivent qui regroupe les informations du cosinus et du sinus (on pourra ajouter une légende) :</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>donnees <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">X=</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>pi,<span class="dv">2</span><span class="sc">*</span>pi,<span class="at">by=</span><span class="fl">0.001</span>),</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">cos=</span><span class="fu">cos</span>(X),<span class="at">sin=</span><span class="fu">sin</span>(X))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(donnees)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>cos)<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>sin),<span class="at">color=</span><span class="st">"red"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ou pour la légende</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(donnees)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>cos)<span class="sc">+</span><span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="st">"cos"</span>))<span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y=</span>sin,<span class="at">color=</span><span class="st">"sin"</span>))<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"Fonction"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-65-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Faire la même chose avec un jeu de données et un seul appel à <code>geom_line</code>. On pourra utiliser la fonction <strong>pivot_longer</strong> du <strong>tidyverse</strong>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> donnees <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(cos,sin),</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Fonction"</span>,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ou</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> donnees <span class="sc">|&gt;</span> </span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>X,</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Fonction"</span>,</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>)</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>value,<span class="at">color=</span>Fonction)<span class="sc">+</span><span class="fu">geom_line</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># on peut aussi ne pas créer de tibble intermédiaire</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>donnees <span class="sc">|&gt;</span> </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="sc">-</span>X,</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">"Fonction"</span>,</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">"value"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>()<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>value,<span class="at">color=</span>Fonction)<span class="sc">+</span><span class="fu">geom_line</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-66-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Tracer les deux fonctions sur deux fenêtres graphiques (utiliser <code>facet_wrap</code>).</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>value)<span class="sc">+</span><span class="fu">geom_line</span>()<span class="sc">+</span><span class="fu">facet_wrap</span>(<span class="sc">~</span>Fonction)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Faire la même chose avec la fonction <code>grid.arrange</code> du package <strong>gridExtra</strong>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(donnees1)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>cos)<span class="sc">+</span><span class="fu">geom_line</span>()</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(donnees2)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>sin)<span class="sc">+</span><span class="fu">geom_line</span>()</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(p1,p2,<span class="at">nrow=</span><span class="dv">1</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ol>
</div>
<div id="exr-exo-mtcars" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.10 (Différents graphes)</strong></span> On considère les données <code>mtcars</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mtcars)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      mpg             cyl             disp             hp       
 Min.   :10.40   Min.   :4.000   Min.   : 71.1   Min.   : 52.0  
 1st Qu.:15.43   1st Qu.:4.000   1st Qu.:120.8   1st Qu.: 96.5  
 Median :19.20   Median :6.000   Median :196.3   Median :123.0  
 Mean   :20.09   Mean   :6.188   Mean   :230.7   Mean   :146.7  
 3rd Qu.:22.80   3rd Qu.:8.000   3rd Qu.:326.0   3rd Qu.:180.0  
 Max.   :33.90   Max.   :8.000   Max.   :472.0   Max.   :335.0  
      drat             wt             qsec             vs        
 Min.   :2.760   Min.   :1.513   Min.   :14.50   Min.   :0.0000  
 1st Qu.:3.080   1st Qu.:2.581   1st Qu.:16.89   1st Qu.:0.0000  
 Median :3.695   Median :3.325   Median :17.71   Median :0.0000  
 Mean   :3.597   Mean   :3.217   Mean   :17.85   Mean   :0.4375  
 3rd Qu.:3.920   3rd Qu.:3.610   3rd Qu.:18.90   3rd Qu.:1.0000  
 Max.   :4.930   Max.   :5.424   Max.   :22.90   Max.   :1.0000  
       am              gear            carb      
 Min.   :0.0000   Min.   :3.000   Min.   :1.000  
 1st Qu.:0.0000   1st Qu.:3.000   1st Qu.:2.000  
 Median :0.0000   Median :4.000   Median :2.000  
 Mean   :0.4062   Mean   :3.688   Mean   :2.812  
 3rd Qu.:1.0000   3rd Qu.:4.000   3rd Qu.:4.000  
 Max.   :1.0000   Max.   :5.000   Max.   :8.000  </code></pre>
</div>
</div>
<ol type="1">
<li><p>Tracer l’histogramme de <code>mpg</code> (on fera varier le nombre de classes).</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>mpg)<span class="sc">+</span><span class="fu">geom_histogram</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>mpg)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-70-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Tracer l’histogramme de la densité.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>mpg,<span class="at">y=</span>..density..)<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">10</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Tracer le diagramme en barres de <code>cyl</code>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>cyl)<span class="sc">+</span><span class="fu">geom_bar</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Tracer le nuage de points <code>disp vs mpg</code> en utilisant une couleur différente pour chaque valeur de <code>cyl</code>.</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>disp,<span class="at">y=</span>mpg,<span class="at">color=</span>cyl)<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>disp,<span class="at">y=</span>mpg,<span class="at">color=</span><span class="fu">as.factor</span>(cyl))<span class="sc">+</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"cyl"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-73-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Ajouter le lisseur linéaire sur le graphe (un lisseur par modalité de <code>cyl</code>).</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>disp,<span class="at">y=</span>mpg,<span class="at">color=</span><span class="fu">as.factor</span>(cyl))<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)<span class="sc">+</span><span class="fu">labs</span>(<span class="at">color=</span><span class="st">"cyl"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ol>
</div>
<div id="exr-ggplot-reg-simple" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.11 (Résidus pour régression simple)</strong></span> On souhaite visualiser les résidus dans un modèle de régression simple.</p>
<ol type="1">
<li><p>Générer un échantillon <span class="math inline">\((x_i,y_i),i=1,\dots,100\)</span> selon le modèle linéaire <span class="math display">\[y_i=3+x_i+\varepsilon_i\]</span> où les <span class="math inline">\(x_i\)</span> sont i.i.d. de loi uniforme sur <span class="math inline">\([0,1]\)</span> et les <span class="math inline">\(\varepsilon_i\)</span> sont i.i.d. de loi gaussienne <span class="math inline">\(N(0,0.2^2)\)</span> (utiliser <strong>runif</strong> et <strong>rnorm</strong>).</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n,<span class="at">sd=</span><span class="fl">0.2</span>)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">+</span>X<span class="sc">+</span>eps</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">tibble</span>(X,Y)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Tracer le nuage de points <strong>Y vs X</strong> et ajouter le lisseur linéaire.</p>
<div class="corR">
<p>On le fait d’abord “à la main” en calculant l’équation de la droite de régression.</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(Y<span class="sc">~</span>.,<span class="at">data=</span>D)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>co <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> D <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">fit=</span><span class="fu">predict</span>(model))</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>D<span class="sc">$</span>fit <span class="ot">&lt;-</span> <span class="fu">predict</span>(model)</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope=</span>co[<span class="dv">2</span>],<span class="at">intercept=</span>co[<span class="dv">1</span>],<span class="at">color=</span><span class="st">"blue"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="corR">
<p>On peut avoir le tracé directement avec <code>geom_smooth</code>.</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>Représenter les résidus : on ajoutera une ligne verticale entre chaque point et la droite de lissage (utiliser <strong>geom_segment</strong>).</p>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(D)<span class="sc">+</span><span class="fu">aes</span>(<span class="at">x=</span>X,<span class="at">y=</span>Y)<span class="sc">+</span><span class="fu">geom_point</span>()<span class="sc">+</span><span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)<span class="sc">+</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_segment</span>(<span class="fu">aes</span>(<span class="at">xend=</span>X,<span class="at">yend=</span>fit))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-78-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ol>
</div>
<div id="exr-ggplot-challenge" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercice 7.12 (Challenge)</strong></span> On considère les données <strong>diamonds</strong>.</p>
<ol type="1">
<li><p>Tracer les graphes suivants.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-79-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-79-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="corR">
<p>On obtient les graphes demandés avec :</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>cut,<span class="at">y=</span>carat,<span class="at">fill=</span>cut)) </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span> <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>cut,<span class="at">fill=</span>cut))</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>..density..)) <span class="sc">+</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(cut<span class="sc">~</span>.)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></li>
<li><p>Ajouter sur le troisième graphe les quartiles de la variable <strong>carat</strong> pour chaque valeur de <strong>cut</strong>. On utilisera une ligne verticale.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>Q1 <span class="ot">&lt;-</span> diamonds <span class="sc">|&gt;</span> <span class="fu">group_by</span>(cut) <span class="sc">|&gt;</span> </span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">q1=</span><span class="fu">quantile</span>(carat,<span class="fu">c</span>(<span class="fl">0.25</span>)),<span class="at">q2=</span><span class="fu">quantile</span>(carat,<span class="fu">c</span>(<span class="fl">0.5</span>)),</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">q3=</span><span class="fu">quantile</span>(carat,<span class="fu">c</span>(<span class="fl">0.75</span>)))</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>quantildf <span class="ot">&lt;-</span> Q1 <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="sc">-</span>cut,<span class="at">names_to=</span><span class="st">"alpha"</span>,<span class="at">values_to=</span><span class="st">"quantiles"</span>)</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span> <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>..density..)) <span class="sc">+</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(cut<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>quantildf,<span class="fu">aes</span>(<span class="at">xintercept=</span>quantiles),<span class="at">col=</span><span class="fu">alpha</span>(<span class="st">"black"</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>))</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-81-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="corR">
<p>On peut aussi l’obtenir avec <strong>stat_boxplot</strong> sans calculer explicitement les quartiles :</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>carat)<span class="sc">+</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="fu">aes</span>(<span class="at">xintercept=</span><span class="fu">c</span>(..xlower..,..xmiddle..,</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>                                ..xupper..)),<span class="at">geom=</span><span class="st">"vline"</span>) <span class="sc">+</span> </span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(cut<span class="sc">~</span>.) </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-82-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="corR">
<p>ou encore avec <strong>stat_summary</strong> :</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>carat)) <span class="sc">+</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span><span class="dv">1</span>,<span class="at">xintercept=</span><span class="fu">after_stat</span>(x)),<span class="at">fun=</span><span class="st">"quantile"</span>,</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun.args =</span> <span class="fu">list</span>(<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>)),</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom=</span><span class="st">"vline"</span>,<span class="at">orientation=</span><span class="st">"y"</span>) <span class="sc">+</span> </span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(cut<span class="sc">~</span>.) </span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
<li><p>En déduire le graphe suivant.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="corR">
<p>On l’obtient avec</p>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data=</span>diamonds,<span class="fu">aes</span>(<span class="at">y=</span><span class="sc">-</span><span class="fl">0.5</span>,<span class="at">x=</span>carat,<span class="at">fill=</span>cut)) <span class="sc">+</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(<span class="at">x=</span>carat,<span class="at">y=</span>..density..)) <span class="sc">+</span>  <span class="fu">facet_grid</span>(cut<span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>quantildf,<span class="fu">aes</span>(<span class="at">xintercept=</span>quantiles),<span class="at">col=</span><span class="fu">alpha</span>(<span class="st">"black"</span>,<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">""</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="corR">
<p>ou encore</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>diamonds) <span class="sc">+</span> <span class="fu">aes</span>(<span class="at">x=</span>carat)<span class="sc">+</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data=</span>diamonds,<span class="fu">aes</span>(<span class="at">y=</span><span class="sc">-</span><span class="fl">0.5</span>,<span class="at">x=</span>carat,<span class="at">fill=</span>cut)) <span class="sc">+</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_boxplot</span>(<span class="fu">aes</span>(<span class="at">xintercept=</span><span class="fu">c</span>(..xlower..,..xmiddle..,</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>                            ..xupper..)),<span class="at">geom=</span><span class="st">"vline"</span>) <span class="sc">+</span> </span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(cut<span class="sc">~</span>.)<span class="sc">+</span><span class="fu">ylab</span>(<span class="st">""</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="corR">
<p>ou encore avec <strong>stat_summary</strong> :</p>
</div>
<div class="cell" data-teacher="true">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>diamonds <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>carat)) <span class="sc">+</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">data=</span>diamonds,<span class="fu">aes</span>(<span class="at">y=</span><span class="sc">-</span><span class="fl">0.5</span>,<span class="at">x=</span>carat,<span class="at">fill=</span>cut)) <span class="sc">+</span></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span><span class="dv">1</span>,<span class="at">xintercept=</span><span class="fu">after_stat</span>(x)),<span class="at">fun=</span><span class="st">"quantile"</span>,</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">fun.args =</span> <span class="fu">list</span>(<span class="at">prob=</span><span class="fu">c</span>(<span class="fl">0.25</span>,<span class="fl">0.5</span>,<span class="fl">0.75</span>)),</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom=</span><span class="st">"vline"</span>,<span class="at">orientation=</span><span class="st">"y"</span>) <span class="sc">+</span> </span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_grid</span>(cut<span class="sc">~</span>.) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">""</span>)</span></code><button title="Copier vers le presse-papier" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="07-ggplot_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div></li>
</ol>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copié");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copié");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./06-scraping.html" class="pagination-link" aria-label="Web scraping">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Web scraping</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-carto.html" class="pagination-link" aria-label="Faire des cartes avec R">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Faire des cartes avec R</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>